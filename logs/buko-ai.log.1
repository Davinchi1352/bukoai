2025-07-26 21:33:42 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:42] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:43 [INFO    ] request_middleware  : {"request_id": "306ba941-f35e-4abc-b392-8f0a4061e4c9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 226, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:43.153674Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: [cached since 17.38s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:43 [INFO    ] request_middleware  : {"request_id": "306ba941-f35e-4abc-b392-8f0a4061e4c9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 36, "duration_seconds": 0.003009, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:43.156517Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:43 [INFO    ] request_middleware  : {"request_id": "b73b1542-28b7-4e6f-8bfc-c75b8f0acfa2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 217, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:43.158214Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:43 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:43] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: [cached since 17.39s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:43 [INFO    ] request_middleware  : {"request_id": "b73b1542-28b7-4e6f-8bfc-c75b8f0acfa2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.002892, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:43.160963Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:43 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:43 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:43] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:45 [INFO    ] request_middleware  : {"request_id": "063d62df-e2a2-4dd9-8e74-b91b5282e156", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 226, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:45.301134Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:45 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:45 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:45 [INFO    ] sqlalchemy.engine.Engine: [cached since 19.53s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:45 [INFO    ] request_middleware  : {"request_id": "063d62df-e2a2-4dd9-8e74-b91b5282e156", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 36, "duration_seconds": 0.003126, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:45.304078Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:45 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:45 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:45] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "e47a8b39-8216-4405-878c-12b85e2b0ef1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 218, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.221366Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "1148e4fa-933a-4ec9-93e4-d82ef1d1fe2b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 227, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.222698Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.45s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.45s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "e47a8b39-8216-4405-878c-12b85e2b0ef1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005051, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.226237Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "1148e4fa-933a-4ec9-93e4-d82ef1d1fe2b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004195, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.226748Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "231270ad-7634-4d73-a963-bc95953080b1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 219, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.263157Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "654b59d5-cbf6-42c2-bcf3-690ab2e4b615", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 228, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.264364Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.49s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.49s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "231270ad-7634-4d73-a963-bc95953080b1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005471, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.268464Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "654b59d5-cbf6-42c2-bcf3-690ab2e4b615", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004806, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.269023Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "204c32aa-f13e-401a-8bfc-fd52f9ff06f4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 220, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.370611Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "682358c7-de8b-48cd-9b16-be4140c64553", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 229, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.371669Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.6s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.6s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "204c32aa-f13e-401a-8bfc-fd52f9ff06f4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005031, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.375454Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "682358c7-de8b-48cd-9b16-be4140c64553", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.005481, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.377002Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "41ed7c80-6bc6-491c-b52a-47b9bd0f74c5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 221, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.506016Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "39a1deb6-1878-4aea-978f-b1b1414e5ce9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 230, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.509019Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.73s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.74s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "41ed7c80-6bc6-491c-b52a-47b9bd0f74c5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005274, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.511085Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "39a1deb6-1878-4aea-978f-b1b1414e5ce9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.003465, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.512342Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "b79a13e0-e787-4249-878e-ed61dc969a4d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 222, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.598993Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "dbcf7ba5-952c-4920-ba7f-6189e59fa2bf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 231, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.600004Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.83s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.83s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "b79a13e0-e787-4249-878e-ed61dc969a4d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004466, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.603271Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "dbcf7ba5-952c-4920-ba7f-6189e59fa2bf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004779, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.604629Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "274c8b04-fced-4466-8a25-ff5e7cd85baf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 223, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.645254Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "5527d290-abcf-446a-a8c6-6997194e2650", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 232, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.647412Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "65cae763-d801-4092-bd07-f7778772fa6e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 233, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.650511Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "18cc4d96-41d8-491b-a4aa-5a4bba049ea4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 224, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.651633Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.88s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.88s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "274c8b04-fced-4466-8a25-ff5e7cd85baf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.010461, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.655550Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "5527d290-abcf-446a-a8c6-6997194e2650", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.008968, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.656225Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.89s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 24.89s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "18cc4d96-41d8-491b-a4aa-5a4bba049ea4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.016302, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.667841Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "65cae763-d801-4092-bd07-f7778772fa6e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.018273, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.668636Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "914ed860-39fd-4e0e-a686-59040d71b14d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.717623Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "914ed860-39fd-4e0e-a686-59040d71b14d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000635, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.718085Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:33:50] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "54b3c16d-e744-4272-b622-1dc73dc04a8c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 225, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.928690Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "2a219938-2b18-4552-9a3b-a504aa07e692", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 234, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.929896Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.16s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.16s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "54b3c16d-e744-4272-b622-1dc73dc04a8c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005119, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.933616Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] request_middleware  : {"request_id": "2a219938-2b18-4552-9a3b-a504aa07e692", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004714, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:50.934471Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:50 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:50 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:50] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "22e85673-ea70-420e-9ccf-d0378293cec2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 235, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.026417Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "f8a5bef9-ca16-4a69-afe2-7f3bce7f0f43", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 226, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.028205Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.26s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.26s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "22e85673-ea70-420e-9ccf-d0378293cec2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.005439, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.031662Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "f8a5bef9-ca16-4a69-afe2-7f3bce7f0f43", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004548, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.032632Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "8080cd16-83d8-42a4-bac1-11357a49de2b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 227, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.088488Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.32s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "9410bee7-2965-4ba4-b469-eee798b50a18", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 236, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.091334Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "8080cd16-83d8-42a4-bac1-11357a49de2b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.003783, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.092104Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.32s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "9410bee7-2965-4ba4-b469-eee798b50a18", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.003925, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.095128Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "a1557d8c-6c82-4edf-8e14-c676b404436c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 228, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.196088Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.43s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "01f6725c-fd20-40eb-87a2-681629ff7d75", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 237, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.200067Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "a1557d8c-6c82-4edf-8e14-c676b404436c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005666, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.201547Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.43s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "01f6725c-fd20-40eb-87a2-681629ff7d75", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004094, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.203941Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "36beb102-bea3-4a02-9952-009c78f2c6cb", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 229, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.700766Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "706f42ec-ffe8-4f64-a61d-fe3699f13229", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 238, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.703528Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.93s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "36beb102-bea3-4a02-9952-009c78f2c6cb", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005134, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.705711Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.93s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "706f42ec-ffe8-4f64-a61d-fe3699f13229", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.003942, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.707336Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "c6a074ee-95b3-4997-950e-fb8f8a118c30", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 230, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.728949Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "564c3af7-43db-4c6a-9611-596bd24fba6a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 239, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.730751Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.96s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.96s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "c6a074ee-95b3-4997-950e-fb8f8a118c30", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005775, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.734549Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "564c3af7-43db-4c6a-9611-596bd24fba6a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004416, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.735011Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "8908e8ee-e289-4665-8810-ef12579141ac", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 231, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.757766Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "61ca03e3-3575-4ec4-8200-b80bca49911b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 240, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.759065Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.99s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 25.99s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "8908e8ee-e289-4665-8810-ef12579141ac", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005052, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.762569Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "61ca03e3-3575-4ec4-8200-b80bca49911b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004357, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.763296Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "e0600f4f-bcd1-487a-a6f7-7c7be41c84e6", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 241, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.790963Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "565f694c-2c34-493d-bbff-02e6748a6193", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 232, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.791879Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.02s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.02s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "e0600f4f-bcd1-487a-a6f7-7c7be41c84e6", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004728, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.795488Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "565f694c-2c34-493d-bbff-02e6748a6193", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004347, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.796100Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "da16acd7-4835-4f66-b354-37e3dbcc7ef3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 242, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.818929Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "4104b79a-20ea-4b21-bd69-6cbbe8c41758", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 233, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.819730Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.05s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.05s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "da16acd7-4835-4f66-b354-37e3dbcc7ef3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004383, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.823138Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "4104b79a-20ea-4b21-bd69-6cbbe8c41758", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004193, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.823805Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "64685654-fe2a-4d72-88f9-df5abdb5ae2d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 234, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.847762Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "33d7cf2b-e8aa-473b-ba65-c62938d6eca3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 243, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.849731Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.08s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.08s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "64685654-fe2a-4d72-88f9-df5abdb5ae2d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005685, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.853262Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "33d7cf2b-e8aa-473b-ba65-c62938d6eca3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.00452, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.854090Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "11098c3e-4335-4d8c-a4e4-b34f266d20af", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 244, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.877737Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "7626cb57-8459-434c-93ea-ada12a31029b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 235, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.878833Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.11s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.11s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "11098c3e-4335-4d8c-a4e4-b34f266d20af", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.005646, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.883232Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "7626cb57-8459-434c-93ea-ada12a31029b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.00537, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.884104Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "869ab8ee-8d7b-4290-8b6a-52987e584573", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 236, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.908582Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "d221594f-a36e-40b9-b912-93f0d12ca9e3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 245, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.909608Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.14s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.14s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "869ab8ee-8d7b-4290-8b6a-52987e584573", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004823, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.913226Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "d221594f-a36e-40b9-b912-93f0d12ca9e3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 254, "duration_seconds": 0.004299, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.913779Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "2cb844cd-f870-4f08-9cfe-3a6110b09aa0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 237, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.939575Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "38c3f8c7-c47f-4ded-8ca9-3c2bffb6a8a2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 246, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.941332Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.17s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.17s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "2cb844cd-f870-4f08-9cfe-3a6110b09aa0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004776, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.944189Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "38c3f8c7-c47f-4ded-8ca9-3c2bffb6a8a2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.003803, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.945013Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "9ad7d1ae-982e-438e-a91e-224e6142d477", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 238, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.972391Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "b0ee34cd-2949-492e-b71f-456e3ff72a38", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 247, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.973494Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.2s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.2s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "9ad7d1ae-982e-438e-a91e-224e6142d477", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.00495, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.977152Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] request_middleware  : {"request_id": "b0ee34cd-2949-492e-b71f-456e3ff72a38", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004304, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:51.977663Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:51] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "fda4d566-f2ce-42b9-b6d7-69f9b62af4b2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 239, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.000419Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a9955229-0188-4ea3-821a-b0f046005447", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 248, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.001560Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.23s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.23s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "fda4d566-f2ce-42b9-b6d7-69f9b62af4b2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005015, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.005240Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a9955229-0188-4ea3-821a-b0f046005447", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004502, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.005930Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "666447f4-e683-400d-a09d-7339aad95083", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 240, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.027241Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "8388e8b7-0f17-4c62-9465-ac82bf4c06e1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 249, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.028937Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.26s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.26s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "666447f4-e683-400d-a09d-7339aad95083", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.00581, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.032878Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "8388e8b7-0f17-4c62-9465-ac82bf4c06e1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004675, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.033499Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "78177fc2-e263-4fa4-8898-876409800946", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 241, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.062441Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "f4e1a086-0901-4d49-b164-9722109ed125", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 250, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.063581Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.29s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.29s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "f4e1a086-0901-4d49-b164-9722109ed125", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.005053, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.068510Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "78177fc2-e263-4fa4-8898-876409800946", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.007158, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.069383Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7321c649-fe8e-4baa-a254-8e2611289485", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 242, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.088748Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "c9f25be7-ba52-45e2-ac62-ca3d28389ebe", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 251, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.090573Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.32s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.32s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7321c649-fe8e-4baa-a254-8e2611289485", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004812, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.093392Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "c9f25be7-ba52-45e2-ac62-ca3d28389ebe", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.003455, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.093897Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "d0ca997b-0981-4cd9-af77-637d516181d0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 243, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.120083Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "cdd8ff68-5d78-412d-802e-271d1d2e13a7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 252, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.121173Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.35s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.35s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "d0ca997b-0981-4cd9-af77-637d516181d0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004461, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.124333Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "cdd8ff68-5d78-412d-802e-271d1d2e13a7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004595, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.125643Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "e7976561-244b-4b87-9288-ccdc24e1bdb5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 244, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.148087Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "881c7754-1df5-404d-9886-d43a2b7875d7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 253, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.149687Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.38s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.38s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "e7976561-244b-4b87-9288-ccdc24e1bdb5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005506, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.153360Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "881c7754-1df5-404d-9886-d43a2b7875d7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004314, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.153856Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7269c223-7e0c-48da-92aa-2343d79b45ec", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 245, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.179332Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7555af43-3bc7-4c5a-b9e7-feb8fe30aa8e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 254, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.180782Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.41s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.41s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7269c223-7e0c-48da-92aa-2343d79b45ec", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.006246, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.185417Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7555af43-3bc7-4c5a-b9e7-feb8fe30aa8e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.006269, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.186862Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "2b33f790-c018-48de-980b-8686cbeab21f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 246, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.208984Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "8d6bd6db-c2e1-4ceb-afaa-49bfb22b8b0f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 255, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.210652Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.44s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.44s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "2b33f790-c018-48de-980b-8686cbeab21f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005057, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.213895Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "8d6bd6db-c2e1-4ceb-afaa-49bfb22b8b0f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.003865, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.214391Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "68021048-c171-4b2e-968c-74e1af88baaa", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 247, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.241987Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "6e71516f-9ffc-4daa-829e-680e9d2e0cce", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 256, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.242704Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.47s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.47s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "68021048-c171-4b2e-968c-74e1af88baaa", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.00547, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.247326Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "6e71516f-9ffc-4daa-829e-680e9d2e0cce", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.068674, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.311261Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a71e8747-846e-47dd-98d1-01bff93e16c2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 257, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.312404Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "0d85955a-da4a-4f48-8ab9-6583efa06d71", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 248, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.312871Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "b3da1382-23d1-465c-a6dd-5672cb4c682a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 249, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.313998Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "cdd87f1e-cccf-4bdd-8eb8-92fe179179a4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 258, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.316083Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.55s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.55s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.55s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a71e8747-846e-47dd-98d1-01bff93e16c2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.013941, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.326231Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.55s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "0d85955a-da4a-4f48-8ab9-6583efa06d71", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.014946, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.327735Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "cdd87f1e-cccf-4bdd-8eb8-92fe179179a4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.012705, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.328665Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "f4c189c3-8adb-40e2-9a02-e879a2fca0d6", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 250, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.331046Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "b3da1382-23d1-465c-a6dd-5672cb4c682a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.018165, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.332101Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a7a52887-04b9-43a8-93ca-899512ffbfae", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 259, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.334098Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.57s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.57s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "f4c189c3-8adb-40e2-9a02-e879a2fca0d6", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.011754, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.342644Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a7a52887-04b9-43a8-93ca-899512ffbfae", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.009971, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.343960Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "6ea90d4b-2d6d-40c3-9bf9-354cfd658d66", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 251, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.358533Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "54134b71-2d9d-4a48-ab94-9bdc415bdf4f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 260, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.359646Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.59s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.59s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "6ea90d4b-2d6d-40c3-9bf9-354cfd658d66", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005058, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.363394Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "54134b71-2d9d-4a48-ab94-9bdc415bdf4f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004436, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.364032Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "99373913-9f5e-4ef4-bae2-d151f60609a7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 252, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.389954Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "f65aa0cd-df0e-4871-9701-09e39a16813e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 261, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.390820Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.62s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.62s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "99373913-9f5e-4ef4-bae2-d151f60609a7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004858, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.394638Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "f65aa0cd-df0e-4871-9701-09e39a16813e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004457, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.395135Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "edf063fa-57ad-4df9-9391-decaa6b1ed23", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 262, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.421669Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "70df8606-9c31-4b12-884f-791a86fdab63", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 253, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.422673Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.65s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.65s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "edf063fa-57ad-4df9-9391-decaa6b1ed23", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004556, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.426044Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "70df8606-9c31-4b12-884f-791a86fdab63", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004478, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.427029Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "5a8375a9-7ec9-4e08-ad25-6ed796b301d2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 254, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.449947Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "ccb3dfda-315d-429c-9371-a6aad9a0ebdf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 263, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.451910Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.68s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.68s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "5a8375a9-7ec9-4e08-ad25-6ed796b301d2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.00497, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.454736Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "ccb3dfda-315d-429c-9371-a6aad9a0ebdf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.003939, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.455719Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "1d12dae6-f93d-4dbd-a3bb-0530f144bbab", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 255, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.481626Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "1ab6863a-eda4-408b-a89f-700f30324992", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 264, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.483877Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.71s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.71s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "1d12dae6-f93d-4dbd-a3bb-0530f144bbab", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005786, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.487091Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "1ab6863a-eda4-408b-a89f-700f30324992", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.003864, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.487601Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "3c10c8a8-3447-4154-a4db-e665a1d777e9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 256, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.511901Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a63f83f9-42d0-4a14-8d22-c85e62101af8", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 265, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.512919Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.74s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.74s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "3c10c8a8-3447-4154-a4db-e665a1d777e9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.005183, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.516941Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "a63f83f9-42d0-4a14-8d22-c85e62101af8", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.00488, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.517687Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "91c92e39-2d71-4b2e-afb1-cb524cebd8e5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 257, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.543219Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "04e6b134-7c8e-4505-bf97-fe687bf4f58f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 266, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.544357Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.77s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.77s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "91c92e39-2d71-4b2e-afb1-cb524cebd8e5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004597, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.547647Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "04e6b134-7c8e-4505-bf97-fe687bf4f58f", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.00485, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.549084Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "5d360494-321b-4be2-a58c-5e4933b05bdb", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 258, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.569010Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7df442bf-723e-4fdb-a7c9-9a1463836f86", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 267, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.570148Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.8s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 26.8s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "5d360494-321b-4be2-a58c-5e4933b05bdb", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.004992, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.573822Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] request_middleware  : {"request_id": "7df442bf-723e-4fdb-a7c9-9a1463836f86", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 138, "duration_seconds": 0.004475, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:52.574494Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:52] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:54 [INFO    ] request_middleware  : {"request_id": "a0d15d54-44a3-4617-97ee-04e3d8b30d4c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 266, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:54.237745Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:54 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:54 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:54 [INFO    ] sqlalchemy.engine.Engine: [cached since 28.47s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:54 [INFO    ] request_middleware  : {"request_id": "a0d15d54-44a3-4617-97ee-04e3d8b30d4c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.003284, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:54.240840Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:54 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:54 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:54] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:55 [INFO    ] request_middleware  : {"request_id": "c1956c30-a968-437b-bb35-276d5b3cc308", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 277, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:55.391012Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:55 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:55 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:55 [INFO    ] sqlalchemy.engine.Engine: [cached since 29.62s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:55 [INFO    ] request_middleware  : {"request_id": "c1956c30-a968-437b-bb35-276d5b3cc308", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/preview", "endpoint": "books.preview_book", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 880, "duration_seconds": 0.003024, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:55.393857Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:55 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:55 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:55] "POST /books/generate/preview HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:33:56 [INFO    ] request_middleware  : {"request_id": "95648146-748b-456b-b327-adf97ee9e48a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": 286, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:56.228806Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:56 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:33:56 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:56 [INFO    ] sqlalchemy.engine.Engine: [cached since 30.46s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:33:56 [INFO    ] request_middleware  : {"request_id": "95648146-748b-456b-b327-adf97ee9e48a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/generate/validate", "endpoint": "books.validate_step", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 36, "duration_seconds": 0.003284, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:33:56.231985Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:33:56 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:33:56 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:33:56] "POST /books/generate/validate HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:03 [INFO    ] request_middleware  : {"request_id": "8f9c6124-099f-435c-bc6f-d3f5ef8d8ce3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/my-books", "endpoint": "books.my_books", "referrer": "http://localhost:5001/books/generate", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:03.536954Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:03 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:34:03 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:03 [INFO    ] sqlalchemy.engine.Engine: [cached since 37.76s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:03 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.user_id = %(user_id_1)s ORDER BY book_generations.created_at DESC [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:03 [INFO    ] sqlalchemy.engine.Engine: [generated in 0.00033s] {'user_id_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:03 [INFO    ] request_middleware  : {"request_id": "8f9c6124-099f-435c-bc6f-d3f5ef8d8ce3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/my-books", "endpoint": "books.my_books", "referrer": "http://localhost:5001/books/generate", "event_type": "request_end", "status_code": 200, "response_size": 34329, "duration_seconds": 0.027082, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:03.563902Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:03 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:34:03 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:03] "GET /books/my-books HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:03 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:03] "[36mGET /static/css/main.css HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:03 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:03] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] request_middleware  : {"request_id": "66c6bed7-d53d-4a27-972b-defad91c5d8d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/generation/56", "endpoint": "books.generation_status", "referrer": "http://localhost:5001/books/my-books", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:06.691191Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 40.92s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 40.92s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] request_middleware  : {"request_id": "66c6bed7-d53d-4a27-972b-defad91c5d8d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/generation/56", "endpoint": "books.generation_status", "referrer": "http://localhost:5001/books/my-books", "event_type": "request_end", "status_code": 200, "response_size": 64898, "duration_seconds": 0.006703, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:06.697753Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "GET /books/generation/56 HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "[36mGET /static/css/main.css HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Sending packet OPEN data {'sid': '-uquSJzSsMepOmHrAAAC', 'upgrades': ['websocket'], 'pingTimeout': 20000, 'pingInterval': 25000, 'maxPayload': 1000000} [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:34:06 [INFO    ] request_middleware  : {"request_id": "3bd7f502-899b-417b-95a2-ac9165a5e099", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:06.763531Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "GET /socket.io/?EIO=4&transport=polling&t=PX8g4-a HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 40.99s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 40.99s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] request_middleware  : {"request_id": "3bd7f502-899b-417b-95a2-ac9165a5e099", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 680, "duration_seconds": 0.009057, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:06.772439Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Received packet MESSAGE data 0 [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Received request to upgrade to websocket [/usr/local/lib/python3.12/site-packages/engineio/socket.py:90] (handle_get_request)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "GET /socket.io/?EIO=4&transport=polling&t=PX8g4-p&sid=-uquSJzSsMepOmHrAAAC HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 41.01s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "_M0K3w-q-gJ-bg69AAAD", "event": "websocket_connected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.783884Z"} [/app/app/routes/websocket.py:30] (handle_connect)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "_M0K3w-q-gJ-bg69AAAD", "event": "websocket_connected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.783884Z"} [/app/app/routes/websocket.py:30] (handle_connect)
2025-07-26 21:34:06 [INFO    ] socketio.server     : _M0K3w-q-gJ-bg69AAAD is entering room user_1 [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:279] (enter_room)
2025-07-26 21:34:06 [INFO    ] socketio.server     : emitting event "connected" to _M0K3w-q-gJ-bg69AAAD [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:159] (emit)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Sending packet MESSAGE data 2["connected",{"status":"connected","user_id":1,"message":"Connected to Buko AI WebSocket"}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Sending packet MESSAGE data 0{"sid":"_M0K3w-q-gJ-bg69AAAD"} [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "POST /socket.io/?EIO=4&transport=polling&t=PX8g4-o&sid=-uquSJzSsMepOmHrAAAC HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:06] "GET /socket.io/?EIO=4&transport=polling&t=PX8g4_5&sid=-uquSJzSsMepOmHrAAAC HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Upgrade to websocket successful [/usr/local/lib/python3.12/site-packages/engineio/socket.py:219] (_websocket_handler)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Received packet MESSAGE data 2["subscribe_book_progress",{"book_uuid":"39c72066-d78c-46ab-8da0-758e981b9137"}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:34:06 [INFO    ] socketio.server     : received event "subscribe_book_progress" from _M0K3w-q-gJ-bg69AAAD [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:569] (_handle_event)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 41.08s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"data": {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137"}, "authenticated": true, "user_id": 1, "event": "websocket_subscription_attempt", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.853861Z"} [/app/app/routes/websocket.py:68] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"data": {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137"}, "authenticated": true, "user_id": 1, "event": "websocket_subscription_attempt", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.853861Z"} [/app/app/routes/websocket.py:68] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137", "event": "processing_book_uuid", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.854195Z"} [/app/app/routes/websocket.py:80] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137", "event": "processing_book_uuid", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.854195Z"} [/app/app/routes/websocket.py:80] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.uuid = %(uuid_1)s::UUID 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 40.78s ago] {'uuid_1': '39c72066-d78c-46ab-8da0-758e981b9137', 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"book_found": true, "book_id": 56, "event": "book_lookup_result", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.857309Z"} [/app/app/routes/websocket.py:89] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"book_found": true, "book_id": 56, "event": "book_lookup_result", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.857309Z"} [/app/app/routes/websocket.py:89] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] socketio.server     : _M0K3w-q-gJ-bg69AAAD is entering room book_56 [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:279] (enter_room)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"user_id": 1, "book_id": 56, "room": "book_56", "event": "subscribed_to_book_progress", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.857783Z"} [/app/app/routes/websocket.py:110] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] app.routes.websocket: {"user_id": 1, "book_id": 56, "room": "book_56", "event": "subscribed_to_book_progress", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:06.857783Z"} [/app/app/routes/websocket.py:110] (handle_subscribe_book_progress)
2025-07-26 21:34:06 [INFO    ] socketio.server     : emitting event "book_progress" to _M0K3w-q-gJ-bg69AAAD [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:159] (emit)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Sending packet MESSAGE data 2["book_progress",{"book_uuid":"39c72066-d78c-46ab-8da0-758e981b9137","progress":25,"status":"architecture_review","message":null}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:34:06 [INFO    ] socketio.server     : emitting event "subscription_confirmed" to _M0K3w-q-gJ-bg69AAAD [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:159] (emit)
2025-07-26 21:34:06 [INFO    ] engineio.server     : -uquSJzSsMepOmHrAAAC: Sending packet MESSAGE data 2["subscription_confirmed",{"book_uuid":"39c72066-d78c-46ab-8da0-758e981b9137","room":"book_56"}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:34:06 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:34:08 [INFO    ] request_middleware  : {"request_id": "6a8d8ffe-3baa-469f-b8ec-643cf3adefa5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/architecture/56", "endpoint": "books.review_architecture", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:08.820108Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: [cached since 43.05s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: [cached since 43.04s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:08 [INFO    ] request_middleware  : {"request_id": "6a8d8ffe-3baa-469f-b8ec-643cf3adefa5", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/architecture/56", "endpoint": "books.review_architecture", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 120750, "duration_seconds": 0.006126, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:08.826012Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:34:08 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:08] "GET /books/architecture/56 HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: [cached since 43.09s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:34:08 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "_M0K3w-q-gJ-bg69AAAD", "event": "websocket_disconnected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:08.860613Z"} [/app/app/routes/websocket.py:50] (handle_disconnect)
2025-07-26 21:34:08 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "_M0K3w-q-gJ-bg69AAAD", "event": "websocket_disconnected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:34:08.860613Z"} [/app/app/routes/websocket.py:50] (handle_disconnect)
2025-07-26 21:34:08 [INFO    ] socketio.server     : _M0K3w-q-gJ-bg69AAAD is leaving room user_1 [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:293] (leave_room)
2025-07-26 21:34:08 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:34:08 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:08] "GET /socket.io/?EIO=4&transport=websocket&sid=-uquSJzSsMepOmHrAAAC HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:08 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:08] "[36mGET /static/css/main.css HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:08 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:34:08] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:20 [INFO    ] request_middleware  : {"request_id": "47b2827f-a822-4d85-a467-aaeef4d3db9f", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:20.774312Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:20 [INFO    ] request_middleware  : {"request_id": "47b2827f-a822-4d85-a467-aaeef4d3db9f", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000767, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:20.774850Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:20 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:34:20] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:34:50 [INFO    ] request_middleware  : {"request_id": "4ab7fff9-5f46-41aa-909f-658a46879cec", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:50.828772Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:50 [INFO    ] request_middleware  : {"request_id": "4ab7fff9-5f46-41aa-909f-658a46879cec", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000848, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:34:50.829536Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:34:50 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:34:50] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:15 [INFO    ] request_middleware  : {"request_id": "e0002c6a-2693-4a94-ab6a-56d9cde318f2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/architecture/56/edit", "endpoint": "books.edit_architecture", "referrer": "http://localhost:5001/books/architecture/56", "event_type": "request_start", "content_length": 6874, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:15.452371Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: [cached since 109.7s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: [cached since 109.7s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: UPDATE book_generations SET architecture=%(architecture)s, updated_at=now() WHERE book_generations.id = %(book_generations_id)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: [generated in 0.00036s] {'architecture': '{"chapter_count": 10, "estimated_words": 39600, "genre": "self_help", "include_conclusion": true, "include_introduction": true, "include_toc": true,  ... (7472 characters truncated) ... ofundas", "frequency": "En secciones clave", "purpose": "Momentos de introspeci\\u00f3n que ayudan al lector a personalizar las ense\\u00f1anzas."}]}', 'book_generations_id': 56} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:15 [INFO    ] sqlalchemy.engine.Engine: COMMIT [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2695] (_connection_commit_impl)
2025-07-26 21:35:15 [INFO    ] request_middleware  : {"request_id": "e0002c6a-2693-4a94-ab6a-56d9cde318f2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/architecture/56/edit", "endpoint": "books.edit_architecture", "referrer": "http://localhost:5001/books/architecture/56", "event_type": "request_end", "status_code": 200, "response_size": 77, "duration_seconds": 0.014454, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:15.466656Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:15 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:15] "POST /books/architecture/56/edit HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:20 [INFO    ] request_middleware  : {"request_id": "3939e56c-e471-44b2-9483-366fcf27dfd8", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:20.896914Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:20 [INFO    ] request_middleware  : {"request_id": "3939e56c-e471-44b2-9483-366fcf27dfd8", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000987, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:20.897774Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:20 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:35:20] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:34 [INFO    ] request_middleware  : {"request_id": "7ef2750a-d0c0-448b-99e8-4bfd13f8fda1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/architecture/56/approve", "endpoint": "books.approve_architecture", "referrer": "http://localhost:5001/books/architecture/56", "event_type": "request_start", "content_length": 6874, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:34.877602Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [cached since 129.1s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [cached since 129.1s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: INSERT INTO system_logs (user_id, action, details, level, status, ip_address, user_agent, session_id, error_message, error_traceback, execution_time, uuid, created_at, updated_at) VALUES (%(user_id)s, %(action)s, %(details)s, %(level)s, %(status)s, %(ip_address)s, %(user_agent)s, %(session_id)s, %(error_message)s, %(error_traceback)s, %(execution_time)s, %(uuid)s::UUID, now(), now()) RETURNING system_logs.id, system_logs.created_at, system_logs.updated_at [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [generated in 0.00032s] {'user_id': 1, 'action': 'architecture_approval_validation', 'details': '{"book_id": 56, "chapters_count": 10, "characters_count": 4, "special_sections_count": 4, "has_introduction": true, "has_conclusion": true, "target_pages": 180, "estimated_words": 39600}', 'level': 'INFO', 'status': 'SUCCESS', 'ip_address': '172.18.0.1', 'user_agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36', 'session_id': '.eJwlzjEOwzAIQNG7eO5gDBicy0RgiNo1aaaqd2-qjH_5ep-ybnsez7K89zMfZX1FWUqGYlCAovfwbEBz4oaDh3R0s9qErdM_G9bIXjOqYbRgRKnTSUy6hJM64DToc3J1niOQttRoaabmwgEjqsIAVqW8diJMWC7IeeR-a6B8f7_XLtk.aH3KAQ.8CrnTs5b2YX0-eGQQMML_GPRlgg', 'error_message': None, 'error_traceback': None, 'execution_time': None, 'uuid': UUID('dcc2508a-ef9e-4134-82fc-8f883c547e86')} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: COMMIT [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2695] (_connection_commit_impl)
2025-07-26 21:35:34 [INFO    ] app.utils.logging   : [architecture_approval_validation] {'book_id': 56, 'chapters_count': 10, 'characters_count': 4, 'special_sections_count': 4, 'has_introduction': True, 'has_conclusion': True, 'target_pages': 180, 'estimated_words': 39600} [/app/app/utils/logging.py:65] (log_system_event)
2025-07-26 21:35:34 [INFO    ] app.utils.logging   : [architecture_approval_validation] {'book_id': 56, 'chapters_count': 10, 'characters_count': 4, 'special_sections_count': 4, 'has_introduction': True, 'has_conclusion': True, 'target_pages': 180, 'estimated_words': 39600} [/app/app/utils/logging.py:65] (log_system_event)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [generated in 0.00027s] {'pk_1': 56} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: UPDATE book_generations SET architecture=%(architecture)s, architecture_approved_at=%(architecture_approved_at)s, status=%(status)s, updated_at=now() WHERE book_generations.id = %(book_generations_id)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [generated in 0.00033s] {'architecture': '{"chapter_count": 10, "estimated_words": 39600, "genre": "self_help", "include_conclusion": true, "include_introduction": true, "include_toc": true,  ... (7472 characters truncated) ... ofundas", "frequency": "En secciones clave", "purpose": "Momentos de introspeci\\u00f3n que ayudan al lector a personalizar las ense\\u00f1anzas."}]}', 'architecture_approved_at': datetime.datetime(2025, 7, 26, 21, 35, 34, 894422, tzinfo=datetime.timezone.utc), 'status': 'QUEUED', 'book_generations_id': 56} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: COMMIT [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2695] (_connection_commit_impl)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [generated in 0.00022s] {'pk_1': 56} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: UPDATE book_generations SET task_id=%(task_id)s, updated_at=now() WHERE book_generations.id = %(book_generations_id)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [generated in 0.00032s] {'task_id': '9669d2c8-3344-414e-a47a-79c8b8f119b7', 'book_generations_id': 56} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: COMMIT [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2695] (_connection_commit_impl)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: [cached since 0.02953s ago] {'pk_1': 56} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:34 [INFO    ] request_middleware  : {"request_id": "7ef2750a-d0c0-448b-99e8-4bfd13f8fda1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "POST", "url": "http://localhost:5001/books/architecture/56/approve", "endpoint": "books.approve_architecture", "referrer": "http://localhost:5001/books/architecture/56", "event_type": "request_end", "status_code": 200, "response_size": 166, "duration_seconds": 0.057236, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:34.934676Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:34 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:34 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:34] "POST /books/architecture/56/approve HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] request_middleware  : {"request_id": "97e516c1-22d7-452b-9082-dda28d2841a2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/generation/56", "endpoint": "books.generation_status", "referrer": "http://localhost:5001/books/architecture/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:36.399212Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 130.6s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 130.6s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] request_middleware  : {"request_id": "97e516c1-22d7-452b-9082-dda28d2841a2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/generation/56", "endpoint": "books.generation_status", "referrer": "http://localhost:5001/books/architecture/56", "event_type": "request_end", "status_code": 200, "response_size": 64734, "duration_seconds": 0.005542, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:36.404628Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:36] "GET /books/generation/56 HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:36] "[36mGET /static/css/main.css HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:36] "[36mGET /static/js/main.js HTTP/1.1[0m" 304 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet OPEN data {'sid': '5rvH1qJyQFAR0MhDAAAE', 'upgrades': ['websocket'], 'pingTimeout': 20000, 'pingInterval': 25000, 'maxPayload': 1000000} [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:35:36 [INFO    ] request_middleware  : {"request_id": "148bc7d6-337e-4e8f-96e9-bd208584ca53", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:36.719580Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:36] "GET /socket.io/?EIO=4&transport=polling&t=PX8gQy7 HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 130.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 130.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] request_middleware  : {"request_id": "148bc7d6-337e-4e8f-96e9-bd208584ca53", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 660, "duration_seconds": 0.005972, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:36.725404Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:36] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet MESSAGE data 0 [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 131s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "8AAA1syBzgfDkdeiAAAF", "event": "websocket_connected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.736746Z"} [/app/app/routes/websocket.py:30] (handle_connect)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received request to upgrade to websocket [/usr/local/lib/python3.12/site-packages/engineio/socket.py:90] (handle_get_request)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "8AAA1syBzgfDkdeiAAAF", "event": "websocket_connected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.736746Z"} [/app/app/routes/websocket.py:30] (handle_connect)
2025-07-26 21:35:36 [INFO    ] socketio.server     : 8AAA1syBzgfDkdeiAAAF is entering room user_1 [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:279] (enter_room)
2025-07-26 21:35:36 [INFO    ] socketio.server     : emitting event "connected" to 8AAA1syBzgfDkdeiAAAF [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:159] (emit)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet MESSAGE data 2["connected",{"status":"connected","user_id":1,"message":"Connected to Buko AI WebSocket"}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:36] "GET /socket.io/?EIO=4&transport=polling&t=PX8gQyL.0&sid=5rvH1qJyQFAR0MhDAAAE HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet MESSAGE data 0{"sid":"8AAA1syBzgfDkdeiAAAF"} [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:35:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:36] "POST /socket.io/?EIO=4&transport=polling&t=PX8gQyL&sid=5rvH1qJyQFAR0MhDAAAE HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Upgrade to websocket successful [/usr/local/lib/python3.12/site-packages/engineio/socket.py:219] (_websocket_handler)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet MESSAGE data 2["subscribe_book_progress",{"book_uuid":"39c72066-d78c-46ab-8da0-758e981b9137"}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:35:36 [INFO    ] socketio.server     : received event "subscribe_book_progress" from 8AAA1syBzgfDkdeiAAAF [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:569] (_handle_event)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 131s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"data": {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137"}, "authenticated": true, "user_id": 1, "event": "websocket_subscription_attempt", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.796838Z"} [/app/app/routes/websocket.py:68] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"data": {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137"}, "authenticated": true, "user_id": 1, "event": "websocket_subscription_attempt", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.796838Z"} [/app/app/routes/websocket.py:68] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137", "event": "processing_book_uuid", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.797193Z"} [/app/app/routes/websocket.py:80] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"book_uuid": "39c72066-d78c-46ab-8da0-758e981b9137", "event": "processing_book_uuid", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.797193Z"} [/app/app/routes/websocket.py:80] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.uuid = %(uuid_1)s::UUID 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 130.7s ago] {'uuid_1': '39c72066-d78c-46ab-8da0-758e981b9137', 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"book_found": true, "book_id": 56, "event": "book_lookup_result", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.799608Z"} [/app/app/routes/websocket.py:89] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"book_found": true, "book_id": 56, "event": "book_lookup_result", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.799608Z"} [/app/app/routes/websocket.py:89] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] socketio.server     : 8AAA1syBzgfDkdeiAAAF is entering room book_56 [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:279] (enter_room)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"user_id": 1, "book_id": 56, "room": "book_56", "event": "subscribed_to_book_progress", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.800303Z"} [/app/app/routes/websocket.py:110] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] app.routes.websocket: {"user_id": 1, "book_id": 56, "room": "book_56", "event": "subscribed_to_book_progress", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:35:36.800303Z"} [/app/app/routes/websocket.py:110] (handle_subscribe_book_progress)
2025-07-26 21:35:36 [INFO    ] socketio.server     : emitting event "book_progress" to 8AAA1syBzgfDkdeiAAAF [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:159] (emit)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet MESSAGE data 2["book_progress",{"book_uuid":"39c72066-d78c-46ab-8da0-758e981b9137","progress":5,"status":"processing","message":"Iniciando generaci\u00f3n con Claude AI..."}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:35:36 [INFO    ] socketio.server     : emitting event "subscription_confirmed" to 8AAA1syBzgfDkdeiAAAF [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:159] (emit)
2025-07-26 21:35:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet MESSAGE data 2["subscription_confirmed",{"book_uuid":"39c72066-d78c-46ab-8da0-758e981b9137","room":"book_56"}] [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:35:36 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:41 [INFO    ] request_middleware  : {"request_id": "64ed02d0-59b0-4ef8-8c37-df0357e178f1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:41.719235Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:41 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:41 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:41 [INFO    ] sqlalchemy.engine.Engine: [cached since 135.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:41 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:41 [INFO    ] sqlalchemy.engine.Engine: [cached since 135.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:41 [INFO    ] request_middleware  : {"request_id": "64ed02d0-59b0-4ef8-8c37-df0357e178f1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 660, "duration_seconds": 0.004687, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:41.723764Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:41 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:41 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:41] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:46 [INFO    ] request_middleware  : {"request_id": "9bd027cf-5fd1-477e-ac7d-5f3a274289d4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:46.721648Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:46 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:46 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:46 [INFO    ] sqlalchemy.engine.Engine: [cached since 140.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:46 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:46 [INFO    ] sqlalchemy.engine.Engine: [cached since 140.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:46 [INFO    ] request_middleware  : {"request_id": "9bd027cf-5fd1-477e-ac7d-5f3a274289d4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004432, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:46.725915Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:46 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:46 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:46] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:50 [INFO    ] request_middleware  : {"request_id": "a3eb75d6-564c-4bd7-9f37-254e88513635", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:50.970184Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:50 [INFO    ] request_middleware  : {"request_id": "a3eb75d6-564c-4bd7-9f37-254e88513635", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000614, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:50.970637Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:50 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:35:50] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:51 [INFO    ] request_middleware  : {"request_id": "f23568a4-168f-4631-b0e4-8ef28f121377", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:51.719488Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 145.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:51 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 145.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:51 [INFO    ] request_middleware  : {"request_id": "f23568a4-168f-4631-b0e4-8ef28f121377", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004318, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:51.723652Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:51] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:35:56 [INFO    ] request_middleware  : {"request_id": "32aae1c7-3491-4ec0-aead-1382317dc2df", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:56.721099Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:56 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:35:56 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:56 [INFO    ] sqlalchemy.engine.Engine: [cached since 150.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:56 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:56 [INFO    ] sqlalchemy.engine.Engine: [cached since 150.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:35:56 [INFO    ] request_middleware  : {"request_id": "32aae1c7-3491-4ec0-aead-1382317dc2df", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004681, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:35:56.725606Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:35:56 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:35:56 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:35:56] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:01 [INFO    ] request_middleware  : {"request_id": "02e5179c-f5ad-4335-9cc3-b75c00075314", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:01.719170Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:01 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:36:01 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:01 [INFO    ] sqlalchemy.engine.Engine: [cached since 155.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:36:01 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:01 [INFO    ] sqlalchemy.engine.Engine: [cached since 155.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:01 [INFO    ] request_middleware  : {"request_id": "02e5179c-f5ad-4335-9cc3-b75c00075314", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.005545, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:01.724582Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:01 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:01 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:01] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:06 [INFO    ] request_middleware  : {"request_id": "ad119219-1b49-4bfb-bf2a-6e8c9a3c8a47", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:06.719411Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:06 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:06 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 160.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:06 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 160.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:06 [INFO    ] request_middleware  : {"request_id": "ad119219-1b49-4bfb-bf2a-6e8c9a3c8a47", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 660, "duration_seconds": 0.004343, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:06.723606Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:06 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:06] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:12 [INFO    ] request_middleware  : {"request_id": "e3c1bc58-e2be-41e5-81a4-b8ad509c5123", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:12.177916Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:12 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:12 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:12 [INFO    ] sqlalchemy.engine.Engine: [cached since 166.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:12 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:12 [INFO    ] sqlalchemy.engine.Engine: [cached since 166.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:12 [INFO    ] request_middleware  : {"request_id": "e3c1bc58-e2be-41e5-81a4-b8ad509c5123", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.00503, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:12.182796Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:12 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:12 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:12] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:16 [INFO    ] request_middleware  : {"request_id": "2de28ce7-a981-48f4-869f-a83af0f77c5a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:16.725961Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:16 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:16 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:16 [INFO    ] sqlalchemy.engine.Engine: [cached since 171s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:16 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:16 [INFO    ] sqlalchemy.engine.Engine: [cached since 170.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:16 [INFO    ] request_middleware  : {"request_id": "2de28ce7-a981-48f4-869f-a83af0f77c5a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.005445, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:16.731272Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:16 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:16 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:16] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:21 [INFO    ] request_middleware  : {"request_id": "cc0fe929-e5a3-45d7-b2b7-5a56b8973898", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:21.031787Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:21 [INFO    ] request_middleware  : {"request_id": "cc0fe929-e5a3-45d7-b2b7-5a56b8973898", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000648, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:21.032279Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:36:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:21 [INFO    ] request_middleware  : {"request_id": "34dd3505-40ca-4dd1-9b67-e70c59c72957", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:21.730122Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:21 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:21 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:21 [INFO    ] sqlalchemy.engine.Engine: [cached since 176s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:21 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:21 [INFO    ] sqlalchemy.engine.Engine: [cached since 176s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:21 [INFO    ] request_middleware  : {"request_id": "34dd3505-40ca-4dd1-9b67-e70c59c72957", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.005191, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:21.735177Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:21 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:21 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:21] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:36:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:36:26 [INFO    ] request_middleware  : {"request_id": "ceba32d0-0749-4496-b11f-bac4c857d0c4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:26.727140Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:26 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:26 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:26 [INFO    ] sqlalchemy.engine.Engine: [cached since 181s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:26 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:26 [INFO    ] sqlalchemy.engine.Engine: [cached since 181s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:26 [INFO    ] request_middleware  : {"request_id": "ceba32d0-0749-4496-b11f-bac4c857d0c4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.005065, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:26.732067Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:26 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:26 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:26] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:31 [INFO    ] request_middleware  : {"request_id": "33430739-2954-4764-a78e-d0fbe31f7ccb", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:31.729242Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:31 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:31 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:31 [INFO    ] sqlalchemy.engine.Engine: [cached since 186s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:31 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:31 [INFO    ] sqlalchemy.engine.Engine: [cached since 186s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:31 [INFO    ] request_middleware  : {"request_id": "33430739-2954-4764-a78e-d0fbe31f7ccb", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.00706, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:31.736140Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:31 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:31 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:31] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:36 [INFO    ] request_middleware  : {"request_id": "a7f454b9-44ec-4b68-bd24-01d697444ec4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:36.728380Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:36 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:36 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 191s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:36 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 191s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:36 [INFO    ] request_middleware  : {"request_id": "a7f454b9-44ec-4b68-bd24-01d697444ec4", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.008176, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:36.736390Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:36 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:36] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:41 [INFO    ] request_middleware  : {"request_id": "1d56ab1c-0782-4c71-8969-804c60f44d09", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:41.736429Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:41 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:41 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:41 [INFO    ] sqlalchemy.engine.Engine: [cached since 196s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:41 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:41 [INFO    ] sqlalchemy.engine.Engine: [cached since 196s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:41 [INFO    ] request_middleware  : {"request_id": "1d56ab1c-0782-4c71-8969-804c60f44d09", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.005536, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:41.741809Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:41 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:41 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:41] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:46 [INFO    ] request_middleware  : {"request_id": "4f903bcd-c875-4304-b05b-2a34e857a207", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:46.736934Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:46 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:46 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:46 [INFO    ] sqlalchemy.engine.Engine: [cached since 201s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:46 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:46 [INFO    ] sqlalchemy.engine.Engine: [cached since 201s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:46 [INFO    ] request_middleware  : {"request_id": "4f903bcd-c875-4304-b05b-2a34e857a207", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.007521, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:46.744273Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:46 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:46 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:46] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:51 [INFO    ] request_middleware  : {"request_id": "bb926d07-8c99-4028-ac6f-bbd4a7a0f463", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:51.098945Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:51 [INFO    ] request_middleware  : {"request_id": "bb926d07-8c99-4028-ac6f-bbd4a7a0f463", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000795, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:51.099571Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:51 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:36:51] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:36:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:36:51 [INFO    ] request_middleware  : {"request_id": "6b5c1891-ebbf-44a4-b235-97c7f04ebe41", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:51.728222Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 206s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:51 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 206s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:51 [INFO    ] request_middleware  : {"request_id": "6b5c1891-ebbf-44a4-b235-97c7f04ebe41", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.004398, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:51.732475Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:51] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:36:56 [INFO    ] request_middleware  : {"request_id": "5ea6c719-ac45-487f-a8fa-d07b2f384062", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:56.723865Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:56 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:36:56 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:56 [INFO    ] sqlalchemy.engine.Engine: [cached since 211s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:56 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:56 [INFO    ] sqlalchemy.engine.Engine: [cached since 210.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:36:56 [INFO    ] request_middleware  : {"request_id": "5ea6c719-ac45-487f-a8fa-d07b2f384062", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.004634, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:36:56.728344Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:36:56 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:36:56 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:36:56] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:01 [INFO    ] request_middleware  : {"request_id": "c86870bd-5b43-413c-98fe-2579b723416c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:01.723424Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:01 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:01 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:01 [INFO    ] sqlalchemy.engine.Engine: [cached since 216s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:01 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:01 [INFO    ] sqlalchemy.engine.Engine: [cached since 215.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:01 [INFO    ] request_middleware  : {"request_id": "c86870bd-5b43-413c-98fe-2579b723416c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.004679, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:01.727993Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:01 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:01 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:01] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:06 [INFO    ] request_middleware  : {"request_id": "7b0bbafe-8f88-4190-94f4-c03e8d0d2ddf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:06.722689Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:06 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:06 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 220.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:06 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:06 [INFO    ] sqlalchemy.engine.Engine: [cached since 220.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:06 [INFO    ] request_middleware  : {"request_id": "7b0bbafe-8f88-4190-94f4-c03e8d0d2ddf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.004657, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:06.727204Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:06 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:06 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:06] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:11 [INFO    ] request_middleware  : {"request_id": "95b2aa62-58a5-409f-8461-ee1b1266362a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:11.720459Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:11 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:11 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:11 [INFO    ] sqlalchemy.engine.Engine: [cached since 225.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:11 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:11 [INFO    ] sqlalchemy.engine.Engine: [cached since 225.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:11 [INFO    ] request_middleware  : {"request_id": "95b2aa62-58a5-409f-8461-ee1b1266362a", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.004365, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:11.724672Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:11 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:11 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:11] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:16 [INFO    ] request_middleware  : {"request_id": "55505420-2adc-40cc-8cee-71ff58fdd686", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:16.720592Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:16 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:16 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:16 [INFO    ] sqlalchemy.engine.Engine: [cached since 231s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:16 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:16 [INFO    ] sqlalchemy.engine.Engine: [cached since 230.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:16 [INFO    ] request_middleware  : {"request_id": "55505420-2adc-40cc-8cee-71ff58fdd686", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.007517, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:16.727994Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:37:16 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:16 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:16] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:37:21 [INFO    ] request_middleware  : {"request_id": "7d5cccde-5da7-4be0-a427-75d307423c8f", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:21.176711Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:21 [INFO    ] request_middleware  : {"request_id": "7d5cccde-5da7-4be0-a427-75d307423c8f", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000596, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:21.177138Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:37:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:21 [INFO    ] request_middleware  : {"request_id": "d7d999bf-6219-4924-8e04-ffba39552f1c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:21.720485Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:21 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:21 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:21 [INFO    ] sqlalchemy.engine.Engine: [cached since 235.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:21 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:21 [INFO    ] sqlalchemy.engine.Engine: [cached since 235.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:21 [INFO    ] request_middleware  : {"request_id": "d7d999bf-6219-4924-8e04-ffba39552f1c", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004209, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:21.724547Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:21 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:21 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:21] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:27 [INFO    ] request_middleware  : {"request_id": "8a26da26-b5e5-482f-a7b2-05ac1c94cec0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:27.183545Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:27 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:27 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:27 [INFO    ] sqlalchemy.engine.Engine: [cached since 241.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:27 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:27 [INFO    ] sqlalchemy.engine.Engine: [cached since 241.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:27 [INFO    ] request_middleware  : {"request_id": "8a26da26-b5e5-482f-a7b2-05ac1c94cec0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.006216, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:27.189634Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:27 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:27 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:27] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:32 [INFO    ] request_middleware  : {"request_id": "204565b4-18e2-4088-b766-dc16cf175ca6", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:32.188006Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:32 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:32 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:32 [INFO    ] sqlalchemy.engine.Engine: [cached since 246.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:32 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:32 [INFO    ] sqlalchemy.engine.Engine: [cached since 246.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:32 [INFO    ] request_middleware  : {"request_id": "204565b4-18e2-4088-b766-dc16cf175ca6", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004451, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:32.192266Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:32 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:32 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:32] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:37 [INFO    ] request_middleware  : {"request_id": "8df927f9-4bda-4cf1-acba-2e8c4e29382b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:37.175258Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:37 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:37 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:37 [INFO    ] sqlalchemy.engine.Engine: [cached since 251.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:37 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:37 [INFO    ] sqlalchemy.engine.Engine: [cached since 251.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:37 [INFO    ] request_middleware  : {"request_id": "8df927f9-4bda-4cf1-acba-2e8c4e29382b", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004747, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:37.179862Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:37 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:37 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:37] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:37:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:37:42 [INFO    ] request_middleware  : {"request_id": "8e7f98d9-e6f2-498d-9e17-23f5c2de74f3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:42.189357Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:42 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:42 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:42 [INFO    ] sqlalchemy.engine.Engine: [cached since 256.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:42 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:42 [INFO    ] sqlalchemy.engine.Engine: [cached since 256.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:42 [INFO    ] request_middleware  : {"request_id": "8e7f98d9-e6f2-498d-9e17-23f5c2de74f3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004222, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:42.193407Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:42 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:42 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:42] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:47 [INFO    ] request_middleware  : {"request_id": "b257778a-2aad-482a-92ee-8b6a93ea80c1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:47.177674Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:47 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:47 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:47 [INFO    ] sqlalchemy.engine.Engine: [cached since 261.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:47 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:47 [INFO    ] sqlalchemy.engine.Engine: [cached since 261.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:47 [INFO    ] request_middleware  : {"request_id": "b257778a-2aad-482a-92ee-8b6a93ea80c1", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.00608, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:47.183531Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:47 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:47 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:47] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:51 [INFO    ] request_middleware  : {"request_id": "4c929397-f588-4471-92e0-b76eee7daa01", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:51.250349Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:51 [INFO    ] request_middleware  : {"request_id": "4c929397-f588-4471-92e0-b76eee7daa01", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000618, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:51.250822Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:51 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:37:51] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:52 [INFO    ] request_middleware  : {"request_id": "13689c97-fc0f-4299-8851-bee4ecaabf89", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:52.182609Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 266.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:52 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 266.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:52 [INFO    ] request_middleware  : {"request_id": "13689c97-fc0f-4299-8851-bee4ecaabf89", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.004558, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:52.187007Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:52] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:37:57 [INFO    ] request_middleware  : {"request_id": "2a650547-979a-4bdc-abf6-43b12d29cdcc", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:57.181874Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:57 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:37:57 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:57 [INFO    ] sqlalchemy.engine.Engine: [cached since 271.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:57 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:57 [INFO    ] sqlalchemy.engine.Engine: [cached since 271.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:37:57 [INFO    ] request_middleware  : {"request_id": "2a650547-979a-4bdc-abf6-43b12d29cdcc", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004156, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:37:57.185893Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:37:57 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:37:57 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:37:57] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:02 [INFO    ] request_middleware  : {"request_id": "ffc86af9-b635-4c47-90e1-f05d401da59e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:02.185611Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:02 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:38:02 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:02 [INFO    ] sqlalchemy.engine.Engine: [cached since 276.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:02 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:02 [INFO    ] sqlalchemy.engine.Engine: [cached since 276.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:02 [INFO    ] request_middleware  : {"request_id": "ffc86af9-b635-4c47-90e1-f05d401da59e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004016, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:02.189490Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:02 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:38:02 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:38:02] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:38:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:38:07 [INFO    ] request_middleware  : {"request_id": "6578570b-f629-4c0d-bd34-f1dd220bd27e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:07.176958Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:07 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:38:07 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:07 [INFO    ] sqlalchemy.engine.Engine: [cached since 281.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:07 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:07 [INFO    ] sqlalchemy.engine.Engine: [cached since 281.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:07 [INFO    ] request_middleware  : {"request_id": "6578570b-f629-4c0d-bd34-f1dd220bd27e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.00462, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:07.181446Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:07 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:38:07 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:38:07] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:12 [INFO    ] request_middleware  : {"request_id": "4c07d78f-0c39-4f64-977b-a5741b663fdc", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:12.185735Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:12 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:38:12 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:12 [INFO    ] sqlalchemy.engine.Engine: [cached since 286.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:12 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:12 [INFO    ] sqlalchemy.engine.Engine: [cached since 286.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:12 [INFO    ] request_middleware  : {"request_id": "4c07d78f-0c39-4f64-977b-a5741b663fdc", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004193, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:12.189791Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:12 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:38:12 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:38:12] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:17 [INFO    ] request_middleware  : {"request_id": "a8fded1f-374d-4ded-bc34-4ac395fe741e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:17.184099Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:17 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:38:17 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:17 [INFO    ] sqlalchemy.engine.Engine: [cached since 291.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:17 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:17 [INFO    ] sqlalchemy.engine.Engine: [cached since 291.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:17 [INFO    ] request_middleware  : {"request_id": "a8fded1f-374d-4ded-bc34-4ac395fe741e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004423, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:17.188344Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:17 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:38:17 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:38:17] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:21 [INFO    ] request_middleware  : {"request_id": "7962676d-2fb1-4745-849c-622fcc017425", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:21.305261Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:21 [INFO    ] request_middleware  : {"request_id": "7962676d-2fb1-4745-849c-622fcc017425", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000631, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:21.305729Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:38:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:22 [INFO    ] request_middleware  : {"request_id": "0d709f3a-94b4-4031-81b0-3ed87280c726", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:22.191165Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:22 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:38:22 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:22 [INFO    ] sqlalchemy.engine.Engine: [cached since 296.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:22 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:22 [INFO    ] sqlalchemy.engine.Engine: [cached since 296.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:38:22 [INFO    ] request_middleware  : {"request_id": "0d709f3a-94b4-4031-81b0-3ed87280c726", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.007289, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:22.198338Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:22 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:38:22 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:38:22] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:38:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:38:51 [INFO    ] request_middleware  : {"request_id": "69684500-5d99-4b63-89db-764a43f4d468", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:51.376382Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:51 [INFO    ] request_middleware  : {"request_id": "69684500-5d99-4b63-89db-764a43f4d468", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000585, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:38:51.376820Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:38:51 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:38:51] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:38:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:38:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:39:18 [INFO    ] request_middleware  : {"request_id": "44034435-15ed-4e7b-9711-136dbcd972a7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:39:18.190048Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:39:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:39:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:39:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 352.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:39:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:39:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 352.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:39:18 [INFO    ] request_middleware  : {"request_id": "44034435-15ed-4e7b-9711-136dbcd972a7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 653, "duration_seconds": 0.005194, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:39:18.195079Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:39:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:39:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:39:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:39:21 [INFO    ] request_middleware  : {"request_id": "3785bb70-ff59-403a-9694-52c240a2a8ee", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:39:21.439573Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:39:21 [INFO    ] request_middleware  : {"request_id": "3785bb70-ff59-403a-9694-52c240a2a8ee", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.001111, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:39:21.440544Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:39:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:39:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:39:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:39:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:39:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:39:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:39:51 [INFO    ] request_middleware  : {"request_id": "243be632-aac7-4be5-9921-088293f5bffa", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:39:51.495531Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:39:51 [INFO    ] request_middleware  : {"request_id": "243be632-aac7-4be5-9921-088293f5bffa", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000669, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:39:51.496051Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:39:51 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:39:51] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:40:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:40:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:40:18 [INFO    ] request_middleware  : {"request_id": "cdbc2c07-1a92-41a7-86d8-3e0408607b99", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:40:18.177060Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:40:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:40:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:40:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 412.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:40:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:40:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 412.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:40:18 [INFO    ] request_middleware  : {"request_id": "cdbc2c07-1a92-41a7-86d8-3e0408607b99", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 653, "duration_seconds": 0.008437, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:40:18.185103Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:40:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:40:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:40:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:40:21 [INFO    ] request_middleware  : {"request_id": "d4739c45-8aeb-48bf-839d-cbff099ac473", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:40:21.544535Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:40:21 [INFO    ] request_middleware  : {"request_id": "d4739c45-8aeb-48bf-839d-cbff099ac473", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000672, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:40:21.545086Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:40:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:40:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:40:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:40:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:40:51 [INFO    ] request_middleware  : {"request_id": "31354339-ced1-47aa-9ae4-7412da43c69b", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:40:51.608415Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:40:51 [INFO    ] request_middleware  : {"request_id": "31354339-ced1-47aa-9ae4-7412da43c69b", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000601, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:40:51.608863Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:40:51 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:40:51] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:41:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:41:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:41:18 [INFO    ] request_middleware  : {"request_id": "1e7a9e25-9717-4982-9fb2-cb38fd1b6342", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:41:18.185588Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:41:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:41:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:41:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 472.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:41:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:41:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 472.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:41:18 [INFO    ] request_middleware  : {"request_id": "1e7a9e25-9717-4982-9fb2-cb38fd1b6342", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 653, "duration_seconds": 0.005032, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:41:18.190441Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:41:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:41:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:41:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:41:21 [INFO    ] request_middleware  : {"request_id": "96c79691-b6c4-4c9e-804f-8ee5f7a66296", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:41:21.672793Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:41:21 [INFO    ] request_middleware  : {"request_id": "96c79691-b6c4-4c9e-804f-8ee5f7a66296", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000624, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:41:21.673246Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:41:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:41:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:41:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:41:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:41:51 [INFO    ] request_middleware  : {"request_id": "615cc2fa-4d17-4c88-8fdd-d4cdee95164d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:41:51.727844Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:41:51 [INFO    ] request_middleware  : {"request_id": "615cc2fa-4d17-4c88-8fdd-d4cdee95164d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000962, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:41:51.728657Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:41:51 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:41:51] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:41:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:41:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:42:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:42:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:42:18 [INFO    ] request_middleware  : {"request_id": "25cf19d0-31ce-47be-ba88-c633e991987e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:42:18.181962Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:42:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:42:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:42:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 532.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:42:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:42:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 532.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:42:18 [INFO    ] request_middleware  : {"request_id": "25cf19d0-31ce-47be-ba88-c633e991987e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 653, "duration_seconds": 0.004908, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:42:18.186706Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:42:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:42:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:42:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:42:21 [INFO    ] request_middleware  : {"request_id": "4473a369-665a-4017-9a17-8547e1630255", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:42:21.794183Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:42:21 [INFO    ] request_middleware  : {"request_id": "4473a369-665a-4017-9a17-8547e1630255", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000629, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:42:21.794686Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:42:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:42:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:42:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:42:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:42:51 [INFO    ] request_middleware  : {"request_id": "b5d6171e-64cd-4090-9a81-cd6243bd702d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:42:51.921530Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:42:51 [INFO    ] request_middleware  : {"request_id": "b5d6171e-64cd-4090-9a81-cd6243bd702d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000584, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:42:51.921967Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:42:51 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:42:51] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:43:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:43:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:43:18 [INFO    ] request_middleware  : {"request_id": "2670e728-9f44-45f2-a1f4-36cd31158754", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:43:18.184653Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:43:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:43:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:43:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 592.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:43:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:43:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 592.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:43:18 [INFO    ] request_middleware  : {"request_id": "2670e728-9f44-45f2-a1f4-36cd31158754", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 653, "duration_seconds": 0.004624, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:43:18.189117Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:43:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:43:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:43:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:43:21 [INFO    ] request_middleware  : {"request_id": "2a5a9671-b1db-46e2-9419-b87ae4182b10", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:43:21.983168Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:43:21 [INFO    ] request_middleware  : {"request_id": "2a5a9671-b1db-46e2-9419-b87ae4182b10", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00065, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:43:21.983661Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:43:21 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:43:21] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:43:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:43:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:43:52 [INFO    ] request_middleware  : {"request_id": "4c911f3a-dd48-45db-9edb-7cdaeed985ff", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:43:52.051558Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:43:52 [INFO    ] request_middleware  : {"request_id": "4c911f3a-dd48-45db-9edb-7cdaeed985ff", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000518, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:43:52.051973Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:43:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:43:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:43:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:43:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:44:18 [INFO    ] request_middleware  : {"request_id": "3434cd15-9af6-435c-a046-f7d1e41b28b8", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:44:18.205419Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:44:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:44:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:44:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 652.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:44:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:44:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 652.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:44:18 [INFO    ] request_middleware  : {"request_id": "3434cd15-9af6-435c-a046-f7d1e41b28b8", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 660, "duration_seconds": 0.004598, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:44:18.209861Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:44:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:44:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:44:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:44:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:44:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:44:22 [INFO    ] request_middleware  : {"request_id": "674bec88-2f5d-4253-abad-1f0155881f2d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:44:22.105051Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:44:22 [INFO    ] request_middleware  : {"request_id": "674bec88-2f5d-4253-abad-1f0155881f2d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000677, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:44:22.105571Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:44:22 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:44:22] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:44:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:44:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:44:52 [INFO    ] request_middleware  : {"request_id": "e5ffd2f5-b153-4b1b-8228-2a8ce3f1ef2c", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:44:52.188706Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:44:52 [INFO    ] request_middleware  : {"request_id": "e5ffd2f5-b153-4b1b-8228-2a8ce3f1ef2c", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000665, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:44:52.189215Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:44:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:44:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:45:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:45:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:45:18 [INFO    ] request_middleware  : {"request_id": "e0625cc4-4432-4c22-a64a-9ecfab780df9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:45:18.179764Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:45:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:45:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:45:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 712.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:45:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:45:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 712.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:45:18 [INFO    ] request_middleware  : {"request_id": "e0625cc4-4432-4c22-a64a-9ecfab780df9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 660, "duration_seconds": 0.004861, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:45:18.184450Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:45:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:45:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:45:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:45:22 [INFO    ] request_middleware  : {"request_id": "f3f04fbf-a59c-46c7-9c5c-539585249dc8", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:45:22.255778Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:45:22 [INFO    ] request_middleware  : {"request_id": "f3f04fbf-a59c-46c7-9c5c-539585249dc8", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000601, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:45:22.256248Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:45:22 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:45:22] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:45:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:45:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:45:52 [INFO    ] request_middleware  : {"request_id": "6a7ffa82-700e-474a-9324-03efbead28d9", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:45:52.317008Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:45:52 [INFO    ] request_middleware  : {"request_id": "6a7ffa82-700e-474a-9324-03efbead28d9", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00065, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:45:52.317608Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:45:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:45:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:46:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:46:16 [INFO    ] request_middleware  : {"request_id": "be8fd9ef-87c3-4fe8-a5c7-6769ebf52961", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:16.509729Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:16 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:16 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:16 [INFO    ] sqlalchemy.engine.Engine: [cached since 770.7s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:16 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:16 [INFO    ] sqlalchemy.engine.Engine: [cached since 770.7s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:16 [INFO    ] request_middleware  : {"request_id": "be8fd9ef-87c3-4fe8-a5c7-6769ebf52961", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.008528, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:16.518110Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:16 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:16 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:16] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:21 [INFO    ] request_middleware  : {"request_id": "e0690cdd-a44e-47d1-a996-f5c584bbe820", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:21.720904Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:21 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:21 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:21 [INFO    ] sqlalchemy.engine.Engine: [cached since 775.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:21 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:21 [INFO    ] sqlalchemy.engine.Engine: [cached since 775.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:21 [INFO    ] request_middleware  : {"request_id": "e0690cdd-a44e-47d1-a996-f5c584bbe820", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004279, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:21.725028Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:21 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:21 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:21] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:22 [INFO    ] request_middleware  : {"request_id": "0a2f600e-118d-43ce-87c3-731b43c0cccb", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:22.376312Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:22 [INFO    ] request_middleware  : {"request_id": "0a2f600e-118d-43ce-87c3-731b43c0cccb", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000664, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:22.376834Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:22 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:46:22] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:26 [INFO    ] request_middleware  : {"request_id": "123fcc32-9289-4e33-8276-c137093188a3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:26.719680Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:26 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:26 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:26 [INFO    ] sqlalchemy.engine.Engine: [cached since 780.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:26 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:26 [INFO    ] sqlalchemy.engine.Engine: [cached since 780.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:26 [INFO    ] request_middleware  : {"request_id": "123fcc32-9289-4e33-8276-c137093188a3", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004419, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:26.723962Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:26 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:26 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:26] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:46:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:46:31 [INFO    ] request_middleware  : {"request_id": "fe064fbc-5aff-4b3b-a0a5-3d9ab97778a0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:31.729412Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:31 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:31 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:31 [INFO    ] sqlalchemy.engine.Engine: [cached since 786s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:31 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:31 [INFO    ] sqlalchemy.engine.Engine: [cached since 786s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:31 [INFO    ] request_middleware  : {"request_id": "fe064fbc-5aff-4b3b-a0a5-3d9ab97778a0", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.007138, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:31.736396Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:31 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:31 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:31] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:36 [INFO    ] request_middleware  : {"request_id": "ac5f688b-2462-49f9-96f6-83cdc840c48d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:36.718596Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:36 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:36 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 790.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:36 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:36 [INFO    ] sqlalchemy.engine.Engine: [cached since 790.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:36 [INFO    ] request_middleware  : {"request_id": "ac5f688b-2462-49f9-96f6-83cdc840c48d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004451, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:36.722884Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:36 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:36 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:36] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:41 [INFO    ] request_middleware  : {"request_id": "cf320c73-e9d8-40c0-a3de-d9f9cc0a8855", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:41.718985Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:41 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:41 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:41 [INFO    ] sqlalchemy.engine.Engine: [cached since 795.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:41 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:41 [INFO    ] sqlalchemy.engine.Engine: [cached since 795.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:41 [INFO    ] request_middleware  : {"request_id": "cf320c73-e9d8-40c0-a3de-d9f9cc0a8855", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.00455, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:41.723382Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:41 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:41 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:41] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:46 [INFO    ] request_middleware  : {"request_id": "119beb99-515d-4d0c-a3fc-030fd031e8fd", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:46.731794Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:46 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:46 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:46 [INFO    ] sqlalchemy.engine.Engine: [cached since 801s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:46 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:46 [INFO    ] sqlalchemy.engine.Engine: [cached since 801s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:46 [INFO    ] request_middleware  : {"request_id": "119beb99-515d-4d0c-a3fc-030fd031e8fd", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004389, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:46.736036Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:46 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:46 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:46] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:51 [INFO    ] request_middleware  : {"request_id": "fa4b3655-f927-4c9d-bcca-ad0a0bae5bea", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:51.718285Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:51 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:51 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 805.9s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:51 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:51 [INFO    ] sqlalchemy.engine.Engine: [cached since 805.9s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:51 [INFO    ] request_middleware  : {"request_id": "fa4b3655-f927-4c9d-bcca-ad0a0bae5bea", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004313, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:51.722450Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:51 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:51 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:51] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:46:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:46:52 [INFO    ] request_middleware  : {"request_id": "e3ddb00e-3066-42dd-b766-9639a981dd33", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:52.453015Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:52 [INFO    ] request_middleware  : {"request_id": "e3ddb00e-3066-42dd-b766-9639a981dd33", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00058, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:52.453455Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:46:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:46:57 [INFO    ] request_middleware  : {"request_id": "6b5cd35b-eb86-402b-867a-25f5d2ccd915", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:57.201467Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:57 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:46:57 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:57 [INFO    ] sqlalchemy.engine.Engine: [cached since 811.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:57 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:57 [INFO    ] sqlalchemy.engine.Engine: [cached since 811.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:46:57 [INFO    ] request_middleware  : {"request_id": "6b5cd35b-eb86-402b-867a-25f5d2ccd915", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.005563, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:46:57.206863Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:46:57 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:46:57 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:46:57] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:02 [INFO    ] request_middleware  : {"request_id": "c6c4514a-77dd-4d0f-8c3c-2fe954894248", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:02.178257Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:02 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:02 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:02 [INFO    ] sqlalchemy.engine.Engine: [cached since 816.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:02 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:02 [INFO    ] sqlalchemy.engine.Engine: [cached since 816.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:02 [INFO    ] request_middleware  : {"request_id": "c6c4514a-77dd-4d0f-8c3c-2fe954894248", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004437, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:02.182566Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:02 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:02 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:02] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:07 [INFO    ] request_middleware  : {"request_id": "00fe1be4-84fa-4e3b-9d13-527ff5a9bd84", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:07.178012Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:07 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:07 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:07 [INFO    ] sqlalchemy.engine.Engine: [cached since 821.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:07 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:07 [INFO    ] sqlalchemy.engine.Engine: [cached since 821.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:07 [INFO    ] request_middleware  : {"request_id": "00fe1be4-84fa-4e3b-9d13-527ff5a9bd84", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.005064, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:07.182947Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:07 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:07 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:07] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:12 [INFO    ] request_middleware  : {"request_id": "2b040e38-1e64-4917-8672-cf8d7b7fbf5e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:12.182997Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:12 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:12 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:12 [INFO    ] sqlalchemy.engine.Engine: [cached since 826.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:12 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:12 [INFO    ] sqlalchemy.engine.Engine: [cached since 826.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:12 [INFO    ] request_middleware  : {"request_id": "2b040e38-1e64-4917-8672-cf8d7b7fbf5e", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.007064, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:12.189918Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:12 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:12 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:12] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:47:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:47:17 [INFO    ] request_middleware  : {"request_id": "a81455ea-4627-42b1-96dc-17792d568786", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:17.176525Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:17 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:17 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:17 [INFO    ] sqlalchemy.engine.Engine: [cached since 831.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:17 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:17 [INFO    ] sqlalchemy.engine.Engine: [cached since 831.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:17 [INFO    ] request_middleware  : {"request_id": "a81455ea-4627-42b1-96dc-17792d568786", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.005233, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:17.181608Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:17 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:17 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:17] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:22 [INFO    ] request_middleware  : {"request_id": "d2884317-32ba-4c96-a897-fbbeed9b43bf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:22.182089Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:22 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:22 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:22 [INFO    ] sqlalchemy.engine.Engine: [cached since 836.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:22 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:22 [INFO    ] sqlalchemy.engine.Engine: [cached since 836.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:22 [INFO    ] request_middleware  : {"request_id": "d2884317-32ba-4c96-a897-fbbeed9b43bf", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004526, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:22.186455Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:22 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:22 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:22] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:22 [INFO    ] request_middleware  : {"request_id": "143b1a7c-15a5-4d69-9e00-fa612cec799d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:22.525216Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:22 [INFO    ] request_middleware  : {"request_id": "143b1a7c-15a5-4d69-9e00-fa612cec799d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000618, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:22.525659Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:22 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:47:22] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:27 [INFO    ] request_middleware  : {"request_id": "844eae41-ea61-48e5-a7b9-64c893b0d943", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:27.183196Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:27 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:27 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:27 [INFO    ] sqlalchemy.engine.Engine: [cached since 841.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:27 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:27 [INFO    ] sqlalchemy.engine.Engine: [cached since 841.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:27 [INFO    ] request_middleware  : {"request_id": "844eae41-ea61-48e5-a7b9-64c893b0d943", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.006707, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:27.189685Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:27 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:27 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:27] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:32 [INFO    ] request_middleware  : {"request_id": "63ec59ab-ab0a-46e7-a09f-141d4d384017", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:32.183426Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:32 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:32 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:32 [INFO    ] sqlalchemy.engine.Engine: [cached since 846.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:32 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:32 [INFO    ] sqlalchemy.engine.Engine: [cached since 846.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:32 [INFO    ] request_middleware  : {"request_id": "63ec59ab-ab0a-46e7-a09f-141d4d384017", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.006293, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:32.189564Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:32 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:32 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:32] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:37 [INFO    ] request_middleware  : {"request_id": "50de3116-428a-4f19-b2d7-b155f8c9fade", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:37.179755Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:37 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:37 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:37 [INFO    ] sqlalchemy.engine.Engine: [cached since 851.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:37 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:37 [INFO    ] sqlalchemy.engine.Engine: [cached since 851.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:37 [INFO    ] request_middleware  : {"request_id": "50de3116-428a-4f19-b2d7-b155f8c9fade", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 660, "duration_seconds": 0.005834, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:37.185447Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:37 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:37 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:37] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:47:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:47:42 [INFO    ] request_middleware  : {"request_id": "f1ce7d60-1db0-426b-9b13-9c57704572bc", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:42.181551Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:42 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:42 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:42 [INFO    ] sqlalchemy.engine.Engine: [cached since 856.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:42 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:42 [INFO    ] sqlalchemy.engine.Engine: [cached since 856.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:42 [INFO    ] request_middleware  : {"request_id": "f1ce7d60-1db0-426b-9b13-9c57704572bc", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.006727, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:42.188153Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:42 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:42 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:42] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:47 [INFO    ] request_middleware  : {"request_id": "e44d3c2a-20b1-431f-8d44-c13ee4ce3389", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:47.181256Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:47 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:47 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:47 [INFO    ] sqlalchemy.engine.Engine: [cached since 861.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:47 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:47 [INFO    ] sqlalchemy.engine.Engine: [cached since 861.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:47 [INFO    ] request_middleware  : {"request_id": "e44d3c2a-20b1-431f-8d44-c13ee4ce3389", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 660, "duration_seconds": 0.006625, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:47.187746Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:47 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:47 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:47] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:52 [INFO    ] request_middleware  : {"request_id": "99b5b131-dc28-4691-80c0-d0f97e123230", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:52.182623Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:52 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:47:52 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 866.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:52 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:52 [INFO    ] sqlalchemy.engine.Engine: [cached since 866.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:47:52 [INFO    ] request_middleware  : {"request_id": "99b5b131-dc28-4691-80c0-d0f97e123230", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004074, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:52.186550Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:52 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:47:52 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:47:52] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:47:52 [INFO    ] request_middleware  : {"request_id": "a9cc8dde-560b-4d0a-9e2c-d7f773e96614", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:52.596826Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:52 [INFO    ] request_middleware  : {"request_id": "a9cc8dde-560b-4d0a-9e2c-d7f773e96614", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000629, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:47:52.597287Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:47:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:47:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:48:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:48:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:48:18 [INFO    ] request_middleware  : {"request_id": "f03a21c1-6499-4985-a662-b2e0f11dbb94", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:48:18.184584Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:48:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:48:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:48:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 892.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:48:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:48:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 892.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:48:18 [INFO    ] request_middleware  : {"request_id": "f03a21c1-6499-4985-a662-b2e0f11dbb94", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 659, "duration_seconds": 0.004586, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:48:18.188996Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:48:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:48:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:48:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:48:22 [INFO    ] request_middleware  : {"request_id": "7cb30a8b-f7b6-4c86-a7c1-76711d996bf2", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:48:22.652435Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:48:22 [INFO    ] request_middleware  : {"request_id": "7cb30a8b-f7b6-4c86-a7c1-76711d996bf2", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000648, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:48:22.652942Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:48:22 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:48:22] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:48:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:48:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:48:52 [INFO    ] request_middleware  : {"request_id": "80fbe4e6-46ad-4796-82b5-f8d9bf445173", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:48:52.729613Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:48:52 [INFO    ] request_middleware  : {"request_id": "80fbe4e6-46ad-4796-82b5-f8d9bf445173", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000592, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:48:52.730044Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:48:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:48:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:48:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:48:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:49:18 [INFO    ] request_middleware  : {"request_id": "d5ddaa28-81b5-4cd3-b371-a28012572f2d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:49:18.186433Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:49:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:49:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:49:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 952.4s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:49:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:49:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 952.4s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:49:18 [INFO    ] request_middleware  : {"request_id": "d5ddaa28-81b5-4cd3-b371-a28012572f2d", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004675, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:49:18.190935Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:49:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:49:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:49:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:49:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:49:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:49:22 [INFO    ] request_middleware  : {"request_id": "033d4f28-6be0-4ea8-bffc-4f7c965de220", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:49:22.782310Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:49:22 [INFO    ] request_middleware  : {"request_id": "033d4f28-6be0-4ea8-bffc-4f7c965de220", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000567, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:49:22.782743Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:49:22 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:49:22] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:49:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:49:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:49:52 [INFO    ] request_middleware  : {"request_id": "a7bbb6a8-183e-4302-aec8-256b9c6fa1fb", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:49:52.845177Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:49:52 [INFO    ] request_middleware  : {"request_id": "a7bbb6a8-183e-4302-aec8-256b9c6fa1fb", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000574, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:49:52.845598Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:49:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:49:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:50:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:50:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:50:18 [INFO    ] request_middleware  : {"request_id": "28318f53-55d7-4609-8734-6ba522b48116", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:50:18.185995Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:50:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:50:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:50:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1012s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:50:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:50:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1012s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:50:18 [INFO    ] request_middleware  : {"request_id": "28318f53-55d7-4609-8734-6ba522b48116", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 661, "duration_seconds": 0.004295, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:50:18.190131Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:50:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:50:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:50:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:50:22 [INFO    ] request_middleware  : {"request_id": "071faa42-f89d-4b20-afe2-4efb718c1625", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:50:22.912105Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:50:22 [INFO    ] request_middleware  : {"request_id": "071faa42-f89d-4b20-afe2-4efb718c1625", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000619, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:50:22.912529Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:50:22 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:50:22] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:50:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:50:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:50:52 [INFO    ] request_middleware  : {"request_id": "2c9bc8c7-fbd9-49cf-beb0-e9358426e995", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:50:52.971571Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:50:52 [INFO    ] request_middleware  : {"request_id": "2c9bc8c7-fbd9-49cf-beb0-e9358426e995", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000724, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:50:52.972160Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:50:52 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:50:52] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:51:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:51:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:51:18 [INFO    ] request_middleware  : {"request_id": "ce045ea6-37e0-4387-bbda-741b14102dc7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:51:18.179181Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:51:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:51:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:51:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1072s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:51:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:51:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1072s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:51:18 [INFO    ] request_middleware  : {"request_id": "ce045ea6-37e0-4387-bbda-741b14102dc7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.005289, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:51:18.184304Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:51:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:51:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:51:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:51:23 [INFO    ] request_middleware  : {"request_id": "1f0cb5d7-75bc-4016-a9c9-ace7906934f3", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:51:23.044297Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:51:23 [INFO    ] request_middleware  : {"request_id": "1f0cb5d7-75bc-4016-a9c9-ace7906934f3", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00067, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:51:23.044777Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:51:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:51:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:51:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:51:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:51:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:51:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:51:53 [INFO    ] request_middleware  : {"request_id": "ac259ab4-c79b-4b88-a4f2-93fc0a784689", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:51:53.103438Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:51:53 [INFO    ] request_middleware  : {"request_id": "ac259ab4-c79b-4b88-a4f2-93fc0a784689", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00057, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:51:53.103861Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:51:53 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:51:53] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:52:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:52:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:52:18 [INFO    ] request_middleware  : {"request_id": "5d11a281-7096-4df1-8539-e6777669cbb7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:52:18.182192Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:52:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:52:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:52:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1132s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:52:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:52:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1132s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:52:18 [INFO    ] request_middleware  : {"request_id": "5d11a281-7096-4df1-8539-e6777669cbb7", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 662, "duration_seconds": 0.005239, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:52:18.187275Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:52:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:52:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:52:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:52:23 [INFO    ] request_middleware  : {"request_id": "2971b7a1-7ff1-4350-a4ae-ffdce65cdd80", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:52:23.170033Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:52:23 [INFO    ] request_middleware  : {"request_id": "2971b7a1-7ff1-4350-a4ae-ffdce65cdd80", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00065, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:52:23.170508Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:52:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:52:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:52:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:52:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:52:53 [INFO    ] request_middleware  : {"request_id": "097da24f-bea8-4d7c-a8cb-d32a67bef280", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:52:53.239620Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:52:53 [INFO    ] request_middleware  : {"request_id": "097da24f-bea8-4d7c-a8cb-d32a67bef280", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000708, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:52:53.240193Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:52:53 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:52:53] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:53:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:53:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:53:18 [INFO    ] request_middleware  : {"request_id": "9645b2ef-9cf5-44fc-9c16-b24cb4371541", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:53:18.184148Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:53:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:53:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:53:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1192s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:53:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:53:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1192s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:53:18 [INFO    ] request_middleware  : {"request_id": "9645b2ef-9cf5-44fc-9c16-b24cb4371541", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004931, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:53:18.188889Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:53:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:53:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:53:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:53:23 [INFO    ] request_middleware  : {"request_id": "879e1eed-05f6-4625-9e2f-37a8868fb545", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:53:23.286944Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:53:23 [INFO    ] request_middleware  : {"request_id": "879e1eed-05f6-4625-9e2f-37a8868fb545", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000515, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:53:23.287314Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:53:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:53:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:53:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:53:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:53:53 [INFO    ] request_middleware  : {"request_id": "6822912b-e057-47aa-a4ce-50f6ab44e160", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:53:53.349220Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:53:53 [INFO    ] request_middleware  : {"request_id": "6822912b-e057-47aa-a4ce-50f6ab44e160", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000686, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:53:53.349767Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:53:53 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:53:53] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:53:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:53:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:54:18 [INFO    ] request_middleware  : {"request_id": "f80cc7ea-8e23-4262-955e-169c389801a2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:54:18.186554Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:54:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:54:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:54:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1252s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:54:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:54:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1252s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:54:18 [INFO    ] request_middleware  : {"request_id": "f80cc7ea-8e23-4262-955e-169c389801a2", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004614, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:54:18.191030Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:54:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:54:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:54:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:54:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:54:21 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:54:23 [INFO    ] request_middleware  : {"request_id": "da717a78-8247-4103-8691-fa619e903ce5", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:54:23.390072Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:54:23 [INFO    ] request_middleware  : {"request_id": "da717a78-8247-4103-8691-fa619e903ce5", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00069, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:54:23.390628Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:54:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:54:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:54:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:54:46 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:54:53 [INFO    ] request_middleware  : {"request_id": "3f5181a4-48e6-49f7-b7a9-00253187bdd7", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:54:53.460247Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:54:53 [INFO    ] request_middleware  : {"request_id": "3f5181a4-48e6-49f7-b7a9-00253187bdd7", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000736, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:54:53.460811Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:54:53 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:54:53] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:55:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:55:11 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:55:18 [INFO    ] request_middleware  : {"request_id": "220e2a08-ccfe-43e3-9098-792c818129a9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:55:18.184247Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:55:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:55:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:55:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1312s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:55:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:55:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1312s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:55:18 [INFO    ] request_middleware  : {"request_id": "220e2a08-ccfe-43e3-9098-792c818129a9", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 663, "duration_seconds": 0.004662, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:55:18.188735Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:55:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:55:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:55:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:55:23 [INFO    ] request_middleware  : {"request_id": "ef473a37-e8db-4c7c-9238-faf01061846d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:55:23.520386Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:55:23 [INFO    ] request_middleware  : {"request_id": "ef473a37-e8db-4c7c-9238-faf01061846d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00056, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:55:23.520797Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:55:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:55:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:55:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:55:36 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:55:53 [INFO    ] request_middleware  : {"request_id": "d5e6502b-df01-4ed4-a33b-cd468173e16e", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:55:53.592926Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:55:53 [INFO    ] request_middleware  : {"request_id": "d5e6502b-df01-4ed4-a33b-cd468173e16e", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000622, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:55:53.593401Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:55:53 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:55:53] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:56:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:56:01 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:56:18 [INFO    ] request_middleware  : {"request_id": "d136a8c8-2025-43ca-81db-5c04f10b7223", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:56:18.178475Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:56:18 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:56:18 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:56:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1372s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:56:18 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:56:18 [INFO    ] sqlalchemy.engine.Engine: [cached since 1372s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:56:18 [INFO    ] request_middleware  : {"request_id": "d136a8c8-2025-43ca-81db-5c04f10b7223", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/api/56/status", "endpoint": "books.api_book_status", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 679, "duration_seconds": 0.012631, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:56:18.190990Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:56:18 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:56:18 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:56:18] "GET /books/api/56/status HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:56:23 [INFO    ] request_middleware  : {"request_id": "6842e493-2a31-4f8e-af1e-34b48d50c23c", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:56:23.655157Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:56:23 [INFO    ] request_middleware  : {"request_id": "6842e493-2a31-4f8e-af1e-34b48d50c23c", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000892, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:56:23.655919Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:56:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:56:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:56:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:56:26 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:56:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:56:51 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:56:53 [INFO    ] request_middleware  : {"request_id": "419be0e5-fc5c-485a-801f-d01a23cfcebf", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:56:53.764798Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:56:53 [INFO    ] request_middleware  : {"request_id": "419be0e5-fc5c-485a-801f-d01a23cfcebf", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000662, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:56:53.765287Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:56:53 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:56:53] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:57:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:57:16 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:57:23 [INFO    ] request_middleware  : {"request_id": "19b48010-a821-4be9-a9f2-e69897a8743f", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:57:23.829038Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:57:23 [INFO    ] request_middleware  : {"request_id": "19b48010-a821-4be9-a9f2-e69897a8743f", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000667, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:57:23.829513Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:57:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:57:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:57:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:57:41 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:57:53 [INFO    ] request_middleware  : {"request_id": "81ef02dc-2ae6-46f5-926d-d619dba99d3c", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:57:53.880115Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:57:53 [INFO    ] request_middleware  : {"request_id": "81ef02dc-2ae6-46f5-926d-d619dba99d3c", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000659, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:57:53.880569Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:57:53 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:57:53] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:58:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:58:06 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:58:23 [INFO    ] request_middleware  : {"request_id": "d5444a83-44d8-4304-b2be-6ba0121bb06e", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:58:23.945324Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:58:23 [INFO    ] request_middleware  : {"request_id": "d5444a83-44d8-4304-b2be-6ba0121bb06e", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000667, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:58:23.945827Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:58:23 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:58:23] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:58:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:58:31 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:58:54 [INFO    ] request_middleware  : {"request_id": "3be522ed-a8bb-4462-b4b3-9da225b2608d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:58:54.004792Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:58:54 [INFO    ] request_middleware  : {"request_id": "3be522ed-a8bb-4462-b4b3-9da225b2608d", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000642, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:58:54.005235Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:58:54 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:58:54] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:58:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Sending packet PING data None [/usr/local/lib/python3.12/site-packages/engineio/socket.py:78] (send)
2025-07-26 21:58:56 [INFO    ] engineio.server     : 5rvH1qJyQFAR0MhDAAAE: Received packet PONG data  [/usr/local/lib/python3.12/site-packages/engineio/socket.py:39] (receive)
2025-07-26 21:59:11 [INFO    ] request_middleware  : {"request_id": "98f24293-da48-4e81-8319-4ed19f7f0267", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/book/56", "endpoint": "books.view_book", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:59:11.020366Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: [cached since 1545s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: SELECT book_generations.user_id AS book_generations_user_id, book_generations.title AS book_generations_title, book_generations.genre AS book_generations_genre, book_generations.target_audience AS book_generations_target_audience, book_generations.tone AS book_generations_tone, book_generations.key_topics AS book_generations_key_topics, book_generations.chapter_count AS book_generations_chapter_count, book_generations.page_count AS book_generations_page_count, book_generations.format_size AS book_generations_format_size, book_generations.line_spacing AS book_generations_line_spacing, book_generations.language AS book_generations_language, book_generations.additional_instructions AS book_generations_additional_instructions, book_generations.include_toc AS book_generations_include_toc, book_generations.include_introduction AS book_generations_include_introduction, book_generations.include_conclusion AS book_generations_include_conclusion, book_generations.writing_style AS book_generations_writing_style, book_generations.parameters AS book_generations_parameters, book_generations.content AS book_generations_content, book_generations.thinking_content AS book_generations_thinking_content, book_generations.thinking_length AS book_generations_thinking_length, book_generations.architecture AS book_generations_architecture, book_generations.architecture_approved_at AS book_generations_architecture_approved_at, book_generations.regeneration_feedback_what AS book_generations_regeneration_feedback_what, book_generations.regeneration_feedback_how AS book_generations_regeneration_feedback_how, book_generations.regeneration_history AS book_generations_regeneration_history, book_generations.regeneration_count AS book_generations_regeneration_count, book_generations.status AS book_generations_status, book_generations.task_id AS book_generations_task_id, book_generations.queue_position AS book_generations_queue_position, book_generations.priority AS book_generations_priority, book_generations.prompt_tokens AS book_generations_prompt_tokens, book_generations.completion_tokens AS book_generations_completion_tokens, book_generations.thinking_tokens AS book_generations_thinking_tokens, book_generations.total_tokens AS book_generations_total_tokens, book_generations.estimated_cost AS book_generations_estimated_cost, book_generations.streaming_stats AS book_generations_streaming_stats, book_generations.final_pages AS book_generations_final_pages, book_generations.final_words AS book_generations_final_words, book_generations.file_paths AS book_generations_file_paths, book_generations.cover_url AS book_generations_cover_url, book_generations.error_message AS book_generations_error_message, book_generations.retry_count AS book_generations_retry_count, book_generations.max_retries AS book_generations_max_retries, book_generations.started_at AS book_generations_started_at, book_generations.completed_at AS book_generations_completed_at, book_generations.id AS book_generations_id, book_generations.uuid AS book_generations_uuid, book_generations.created_at AS book_generations_created_at, book_generations.updated_at AS book_generations_updated_at 
FROM book_generations 
WHERE book_generations.id = %(id_1)s AND book_generations.user_id = %(user_id_1)s 
 LIMIT %(param_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: [cached since 1545s ago] {'id_1': 56, 'user_id_1': 1, 'param_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:59:11 [INFO    ] request_middleware  : {"request_id": "98f24293-da48-4e81-8319-4ed19f7f0267", "user_id": null, "ip_address": "172.18.0.1", "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36", "method": "GET", "url": "http://localhost:5001/books/book/56", "endpoint": "books.view_book", "referrer": "http://localhost:5001/books/generation/56", "event_type": "request_end", "status_code": 200, "response_size": 781549, "duration_seconds": 0.026813, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:59:11.046969Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:59:11 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:59:11] "GET /books/book/56 HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: BEGIN (implicit) [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2689] (_connection_begin_impl)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: SELECT users.email AS users_email, users.password_hash AS users_password_hash, users.first_name AS users_first_name, users.last_name AS users_last_name, users.phone_country AS users_phone_country, users.phone_number AS users_phone_number, users.country AS users_country, users.city AS users_city, users.billing_address AS users_billing_address, users.subscription_type AS users_subscription_type, users.subscription_start AS users_subscription_start, users.subscription_end AS users_subscription_end, users.books_used_this_month AS users_books_used_this_month, users.last_reset_date AS users_last_reset_date, users.last_login AS users_last_login, users.email_verified AS users_email_verified, users.email_verification_token AS users_email_verification_token, users.email_verification_expires AS users_email_verification_expires, users.password_reset_token AS users_password_reset_token, users.password_reset_expires AS users_password_reset_expires, users.preferred_language AS users_preferred_language, users.timezone AS users_timezone, users.status AS users_status, users.id AS users_id, users.uuid AS users_uuid, users.created_at AS users_created_at, users.updated_at AS users_updated_at, users.deleted_at AS users_deleted_at 
FROM users 
WHERE users.id = %(pk_1)s [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: [cached since 1545s ago] {'pk_1': 1} [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848] (_execute_context)
2025-07-26 21:59:11 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "8AAA1syBzgfDkdeiAAAF", "event": "websocket_disconnected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:59:11.094346Z"} [/app/app/routes/websocket.py:50] (handle_disconnect)
2025-07-26 21:59:11 [INFO    ] app.routes.websocket: {"user_id": 1, "client_id": "8AAA1syBzgfDkdeiAAAF", "event": "websocket_disconnected", "logger": "app.routes.websocket", "level": "info", "timestamp": "2025-07-26T21:59:11.094346Z"} [/app/app/routes/websocket.py:50] (handle_disconnect)
2025-07-26 21:59:11 [INFO    ] socketio.server     : 8AAA1syBzgfDkdeiAAAF is leaving room user_1 [/] [/usr/local/lib/python3.12/site-packages/socketio/server.py:293] (leave_room)
2025-07-26 21:59:11 [INFO    ] sqlalchemy.engine.Engine: ROLLBACK [/usr/local/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2692] (_connection_rollback_impl)
2025-07-26 21:59:11 [INFO    ] werkzeug            : 172.18.0.1 - - [26/Jul/2025 21:59:11] "GET /socket.io/?EIO=4&transport=websocket&sid=5rvH1qJyQFAR0MhDAAAE HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:59:24 [INFO    ] request_middleware  : {"request_id": "3eabae3c-e8e1-4eec-ba91-3257650fdf3b", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:59:24.065417Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:59:24 [INFO    ] request_middleware  : {"request_id": "3eabae3c-e8e1-4eec-ba91-3257650fdf3b", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000506, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:59:24.065790Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:59:24 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:59:24] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 21:59:54 [INFO    ] request_middleware  : {"request_id": "7dfe8efa-a19d-4d30-9632-e69539f5b62e", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:59:54.123839Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:59:54 [INFO    ] request_middleware  : {"request_id": "7dfe8efa-a19d-4d30-9632-e69539f5b62e", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00061, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T21:59:54.124285Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 21:59:54 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 21:59:54] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 22:00:24 [INFO    ] request_middleware  : {"request_id": "4c18ded1-1625-435d-9939-2cabbb36ce35", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T22:00:24.237419Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 22:00:24 [INFO    ] request_middleware  : {"request_id": "4c18ded1-1625-435d-9939-2cabbb36ce35", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000675, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T22:00:24.237878Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 22:00:24 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 22:00:24] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 22:00:54 [INFO    ] request_middleware  : {"request_id": "eaa92180-9a72-4148-9bc5-28d63bba03fa", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T22:00:54.304801Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 22:00:54 [INFO    ] request_middleware  : {"request_id": "eaa92180-9a72-4148-9bc5-28d63bba03fa", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.000579, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T22:00:54.305215Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 22:00:54 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 22:00:54] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 22:01:24 [INFO    ] request_middleware  : {"request_id": "f33c25bd-a2b7-49a9-9a2c-7cfce1a3a2dd", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_start", "content_length": null, "args": {}, "form_data": {}, "event": "Request started", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T22:01:24.370535Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 22:01:24 [INFO    ] request_middleware  : {"request_id": "f33c25bd-a2b7-49a9-9a2c-7cfce1a3a2dd", "user_id": null, "ip_address": "127.0.0.1", "user_agent": "curl/7.88.1", "method": "GET", "url": "http://localhost:5000/health", "endpoint": "main.health", "referrer": null, "event_type": "request_end", "status_code": 200, "response_size": 79, "duration_seconds": 0.00065, "cache_control": null, "event": "Request completed", "logger": "request_middleware", "level": "info", "timestamp": "2025-07-26T22:01:24.371027Z"} [/app/app/utils/structured_logging.py:80] (log)
2025-07-26 22:01:24 [INFO    ] werkzeug            : 127.0.0.1 - - [26/Jul/2025 22:01:24] "GET /health HTTP/1.1" 200 - [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
2025-07-26 22:01:33 [INFO    ] werkzeug            :  * Detected change in '/app/app/routes/books.py', reloading [/usr/local/lib/python3.12/site-packages/werkzeug/_internal.py:96] (_log)
