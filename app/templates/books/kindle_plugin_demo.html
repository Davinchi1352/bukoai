{% extends "layouts/base.html" %}
{% set active_page = "demo" %}

{% block title %}Demo - Kindle Reader Plugin{% endblock %}

{% block head %}
<script src="{{ url_for('static', filename='js/kindle-reader-plugin.js') }}"></script>

<style>
    body {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
    }

    .demo-section {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }

    .demo-header {
        text-align: center;
        margin-bottom: 40px;
    }

    .demo-header h1 {
        color: var(--primary-color);
        font-size: 2.5em;
        font-weight: 700;
        margin: 0 0 15px 0;
    }

    .demo-description {
        color: var(--secondary-color);
        font-size: 1.1em;
        max-width: 700px;
        margin: 0 auto;
        line-height: 1.6;
    }

    .features-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin: 30px 0;
    }

    .feature-card {
        background: var(--background-tertiary);
        padding: 25px;
        border-radius: 15px;
        text-align: center;
        transition: transform 0.3s ease;
    }

    .feature-card:hover {
        transform: translateY(-5px);
    }

    .feature-icon {
        font-size: 2.5em;
        color: var(--primary-color);
        margin-bottom: 15px;
    }

    .feature-title {
        font-size: 1.2em;
        font-weight: 600;
        color: var(--primary-color);
        margin-bottom: 10px;
    }

    .feature-description {
        color: var(--secondary-color);
        font-size: 0.95em;
        line-height: 1.5;
    }

    .code-example {
        background: #1a1a1a;
        color: #00ff00;
        padding: 20px;
        border-radius: 12px;
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
        overflow-x: auto;
        margin: 20px 0;
    }

    .demo-tabs {
        display: flex;
        border-bottom: 2px solid var(--background-tertiary);
        margin-bottom: 20px;
    }

    .demo-tab {
        background: none;
        border: none;
        padding: 15px 25px;
        cursor: pointer;
        font-weight: 600;
        color: var(--secondary-color);
        transition: all 0.3s ease;
        border-bottom: 3px solid transparent;
    }

    .demo-tab.active {
        color: var(--primary-color);
        border-bottom-color: var(--primary-color);
    }

    .demo-content {
        display: none;
    }

    .demo-content.active {
        display: block;
    }

    .api-method {
        background: var(--background-tertiary);
        padding: 20px;
        border-radius: 12px;
        margin: 15px 0;
        border-left: 4px solid var(--primary-color);
    }

    .method-name {
        font-family: 'Courier New', monospace;
        font-weight: bold;
        color: var(--primary-color);
        font-size: 1.1em;
    }

    .method-description {
        color: var(--secondary-color);
        margin: 10px 0;
    }

    .method-params {
        font-family: 'Courier New', monospace;
        font-size: 0.9em;
        color: var(--text-color);
        background: rgba(0,0,0,0.1);
        padding: 10px;
        border-radius: 8px;
        margin-top: 10px;
    }

    @media (max-width: 768px) {
        .demo-section {
            padding: 20px;
            margin: 10px;
        }

        .demo-tabs {
            flex-wrap: wrap;
        }

        .demo-tab {
            flex: 1;
            min-width: 120px;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- Header -->
    <div class="demo-header">
        <h1>
            <i class="fas fa-puzzle-piece"></i>
            Kindle Reader Plugin
        </h1>
        <p class="demo-description">
            Módulo JavaScript independiente y embebible que simula la experiencia real de lectura de un Kindle. 
            Optimizado para rendimiento, reutilizable y con paginación inteligente.
        </p>
    </div>

    <!-- Features -->
    <div class="demo-section">
        <h2 class="text-center mb-4">
            <i class="fas fa-star"></i>
            Características Principales
        </h2>
        
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-puzzle-piece"></i>
                </div>
                <h3 class="feature-title">Completamente Modular</h3>
                <p class="feature-description">
                    Plugin independiente que puede embeberse en cualquier página web sin dependencias externas.
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <h3 class="feature-title">Paginación Inteligente</h3>
                <p class="feature-description">
                    Detecta automáticamente tabla de contenidos, capítulos y estructura del libro para paginación perfecta.
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h3 class="feature-title">Totalmente Responsivo</h3>
                <p class="feature-description">
                    Se adapta automáticamente a cualquier tamaño de pantalla y dispositivo con gestos táctiles.
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-tachometer-alt"></i>
                </div>
                <h3 class="feature-title">Optimizado Performance</h3>
                <p class="feature-description">
                    Sin forced reflows, cálculos matemáticos en lugar de mediciones DOM, operaciones batch.
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-palette"></i>
                </div>
                <h3 class="feature-title">Múltiples Temas</h3>
                <p class="feature-description">
                    Temas claro, sepia y oscuro con transiciones suaves y personalización completa.
                </p>
            </div>

            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-keyboard"></i>
                </div>
                <h3 class="feature-title">Navegación Completa</h3>
                <p class="feature-description">
                    Teclado, gestos táctiles, botones, swipe - todas las formas de navegación incluidas.
                </p>
            </div>
        </div>
    </div>

    <!-- Documentation -->
    <div class="demo-section">
        <h2 class="text-center mb-4">
            <i class="fas fa-book"></i>
            Documentación
        </h2>

        <div class="demo-tabs">
            <button class="demo-tab active" onclick="showTab('usage')">Uso Básico</button>
            <button class="demo-tab" onclick="showTab('api')">API</button>
            <button class="demo-tab" onclick="showTab('events')">Eventos</button>
            <button class="demo-tab" onclick="showTab('config')">Configuración</button>
        </div>

        <!-- Tab: Usage -->
        <div id="usage" class="demo-content active">
            <h3>🚀 Uso Básico</h3>
            <p>Implementación más simple posible:</p>
            
            <div class="code-example">
&lt;!-- 1. Incluir el plugin --&gt;
&lt;script src="kindle-reader-plugin.js"&gt;&lt;/script&gt;

&lt;!-- 2. Crear contenedor con datos --&gt;
&lt;div data-kindle 
     data-kindle-content="Tu contenido aquí..."
     data-kindle-theme="light"&gt;&lt;/div&gt;

&lt;!-- ¡Eso es todo! El plugin se inicializa automáticamente --&gt;
            </div>

            <h4>📝 Uso Programático</h4>
            <div class="code-example">
// Crear instancia manualmente
const kindle = new KindleReaderPlugin({
    container: '#mi-contenedor',
    content: 'Contenido del libro...',
    fontSize: 16,
    theme: 'sepia'
});

// Inicializar
await kindle.init();
            </div>
        </div>

        <!-- Tab: API -->
        <div id="api" class="demo-content">
            <h3>🔧 API del Plugin</h3>
            
            <div class="api-method">
                <div class="method-name">new KindleReaderPlugin(options)</div>
                <div class="method-description">Crear nueva instancia del plugin</div>
                <div class="method-params">
options: {
    container: '#selector',    // Contenedor CSS
    content: 'texto...',       // Contenido del libro
    fontSize: 16,              // Tamaño de fuente
    theme: 'light',            // Tema: light/sepia/dark
    enableGestures: true,      // Gestos táctiles
    enableSounds: true,        // Sonidos
    showProgress: true         // Barra de progreso
}
                </div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle.init()</div>
                <div class="method-description">Inicializar el plugin (async)</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle.nextPage()</div>
                <div class="method-description">Ir a la página siguiente</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle.previousPage()</div>
                <div class="method-description">Ir a la página anterior</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle.goToPage(pageNumber)</div>
                <div class="method-description">Ir a página específica</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle.setContent(content)</div>
                <div class="method-description">Cambiar contenido dinámicamente</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle.getState()</div>
                <div class="method-description">Obtener estado actual del plugin</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle.destroy()</div>
                <div class="method-description">Destruir instancia y limpiar eventos</div>
            </div>
        </div>

        <!-- Tab: Events -->
        <div id="events" class="demo-content">
            <h3>📡 Eventos del Sistema</h3>
            
            <div class="api-method">
                <div class="method-name">kindle:initialized</div>
                <div class="method-description">Se dispara cuando el plugin termina de inicializarse</div>
                <div class="method-params">
container.addEventListener('kindle:initialized', function(e) {
    console.log('Plugin listo:', e.detail);
});
                </div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle:pageChanged</div>
                <div class="method-description">Se dispara cada vez que cambia la página</div>
                <div class="method-params">
container.addEventListener('kindle:pageChanged', function(e) {
    console.log('Nueva página:', e.detail.currentPage);
});
                </div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle:fontSizeChanged</div>
                <div class="method-description">Se dispara cuando cambia el tamaño de fuente</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle:themeChanged</div>
                <div class="method-description">Se dispara cuando cambia el tema</div>
            </div>

            <div class="api-method">
                <div class="method-name">kindle:destroyed</div>
                <div class="method-description">Se dispara cuando se destruye la instancia</div>
            </div>
        </div>

        <!-- Tab: Config -->
        <div id="config" class="demo-content">
            <h3>⚙️ Configuración Avanzada</h3>
            
            <div class="code-example">
const config = {
    // Contenedor
    container: '#kindle-reader',
    
    // Contenido
    content: 'Texto del libro...',
    
    // Apariencia
    fontSize: 16,                // 12-24
    lineHeight: 1.6,            // 1.2-2.0
    theme: 'light',             // light/sepia/dark
    
    // Funcionalidad
    wordsPerPage: 'auto',       // 'auto' o número
    pageTransition: 'slide',    // slide/fade
    enableSounds: true,         // sonidos
    enableGestures: true,       // gestos táctiles
    showProgress: true,         // barra progreso
    showControls: true          // botones control
};

const kindle = new KindleReaderPlugin(config);
            </div>

            <h4>🎨 Personalización CSS</h4>
            <div class="code-example">
/* Variables CSS que puedes personalizar */
.kindle-plugin {
    --font-size: 16px;
    --line-height: 1.6;
    --primary-color: #232323;
    --bg-color: #ffffff;
    --text-color: #000000;
    --border-color: #d1d1d1;
}

/* Temas automáticos */
.kindle-plugin[data-theme="sepia"] {
    --bg-color: #f4f1e8;
    --text-color: #5c4b37;
}

.kindle-plugin[data-theme="dark"] {
    --bg-color: #1a1a1a;
    --text-color: #e5e5e5;
}
            </div>
        </div>
    </div>

    <!-- Demo en vivo -->
    <div class="demo-section">
        <h2 class="text-center mb-4">
            <i class="fas fa-play-circle"></i>
            Demo en Vivo
        </h2>
        
        <p class="text-center mb-4">
            Plugin funcionando con contenido de ejemplo. Prueba todas las funcionalidades:
        </p>

        <!-- Contenedor del demo -->
        <div id="demo-kindle" 
             data-kindle
             data-kindle-content="# Demo del Kindle Plugin

¡Bienvenido al demo interactivo!

Este es un ejemplo de cómo funciona el plugin Kindle Reader. Puedes navegar usando:

## Navegación
- **Flechas del teclado** ← → para cambiar páginas
- **Botones** en la pantalla del Kindle
- **Gestos táctiles** deslizar en móviles
- **Espacio** para página siguiente
- **Home/End** primera/última página

## Configuración
- Haz clic en el botón de configuración ⚙️
- Cambia el **tamaño de fuente**
- Prueba los diferentes **temas**
- Activa/desactiva **sonidos**

## Tabla de Contenidos
El plugin detecta automáticamente:

1. Tabla de contenidos
2. Capítulos principales  
3. Secciones y subsecciones
4. Contenido genérico

## Capítulo 1: Características

Este plugin es completamente **modular** e **independiente**. No requiere jQuery, Bootstrap u otras dependencias.

### Paginación Inteligente

La paginación respeta:
- Párrafos completos
- Estructura del documento
- Tabla de contenidos
- Transiciones entre secciones

### Performance Optimizado

- Sin forced reflows
- Cálculos matemáticos en lugar de DOM
- Operaciones en batch
- RequestAnimationFrame para animaciones

### Responsive Design

Se adapta automáticamente a:
- Diferentes tamaños de pantalla
- Orientación del dispositivo  
- Cambios de ventana del navegador
- Múltiples dispositivos

## Capítulo 2: Implementación

### Uso Básico
```html
<div data-kindle data-kindle-content='Tu contenido...'></div>
```

### Uso Avanzado
```javascript
const kindle = new KindleReaderPlugin({
    container: '#kindle',
    content: 'Contenido...',
    theme: 'sepia'
});
await kindle.init();
```

## Capítulo 3: Eventos

El plugin emite eventos personalizados:

- `kindle:initialized` - Plugin listo
- `kindle:pageChanged` - Página cambiada
- `kindle:themeChanged` - Tema cambiado
- `kindle:fontSizeChanged` - Fuente cambiada

## Conclusión

Este plugin proporciona una **experiencia de lectura premium** similar a dispositivos Kindle reales, optimizada para web y completamente personalizable.

¡Prueba todas las funcionalidades en este demo!"
             data-kindle-theme="light"
             data-kindle-font-size="16">
            <div style="text-align: center; padding: 50px; color: #666;">
                <div style="width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid #007bff; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 20px;"></div>
                Cargando demo del plugin...
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="demo-section">
        <div class="text-center">
            <h3>🚀 ¿Listo para usar el plugin?</h3>
            <p class="mb-4">El Kindle Reader Plugin está completamente implementado y listo para usar en cualquier proyecto.</p>
            
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <a href="/books" class="btn btn-primary btn-lg">
                    <i class="fas fa-book"></i>
                    Ver Libros
                </a>
                <a href="https://github.com" target="_blank" class="btn btn-outline-primary btn-lg">
                    <i class="fab fa-github"></i>
                    Código Fuente
                </a>
            </div>
        </div>
    </div>
</div>

<script>
// Función para cambiar tabs
function showTab(tabName) {
    // Ocultar todos los contenidos
    document.querySelectorAll('.demo-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // Remover active de todos los tabs
    document.querySelectorAll('.demo-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Mostrar contenido seleccionado
    document.getElementById(tabName).classList.add('active');
    
    // Activar tab seleccionado
    event.target.classList.add('active');
}

// Animación de spin para loading
const style = document.createElement('style');
style.textContent = `
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
`;
document.head.appendChild(style);

// Monitor del demo
document.addEventListener('DOMContentLoaded', function() {
    const demoContainer = document.getElementById('demo-kindle');
    
    if (demoContainer) {
        demoContainer.addEventListener('kindle:initialized', function(e) {
            console.log('✅ Demo inicializado:', e.detail);
        });
        
        demoContainer.addEventListener('kindle:pageChanged', function(e) {
            console.log('📖 Página del demo:', e.detail.currentPage + 1);
        });
    }
});
</script>
{% endblock %}